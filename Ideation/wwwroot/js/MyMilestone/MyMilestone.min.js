function MyMilestone(n,t,i,r,u){$.ajax({type:"POST",url:ROOT+"ProjectTracker/Filtersearch",data:{UserId:n,SearchText:t,Status:i,Type:r,Email:u},dataType:"json",success:function(n){var i,t;if(data=n,i=" ",$("#cardContainer").empty(),n.length>0)for(console.log("response",n.length),$("#cardscount").html("<b>"+n.length+"<\/b>"),t=0;t<n.length;t++)i+=' <div class="col-md-6 col-lg-3">',i+=' <div class="m-block__item">',n[t].MilestoneStatus=="Not Started"?i+=' <div class="m-block__item--title -notstarted" title="Project Name 1">('+n[t].ProjectCode+" )"+n[t].ProjectName+"<\/div>":n[t].MilestoneStatus=="Open"?i+=' <div class="m-block__item--title -open" title="Project Name 1">('+n[t].ProjectCode+" )"+n[t].ProjectName+"<\/div>":n[t].MilestoneStatus=="OverDue"?i+=' <div class="m-block__item--title -overdue" title="Project Name 1">('+n[t].ProjectCode+" )"+n[t].ProjectName+"<\/div>":n[t].MilestoneStatus=="Completed"&&(i+=' <div class="m-block__item--title -completed" title="Project Name 1">('+n[t].ProjectCode+" )"+n[t].ProjectName+"<\/div>"),i+='<div class="m-block__item--content">',i+=' <h5 class="m-block__item--content-title">'+n[t].MilestoneName+"<\/h5>",i+=' <div class="m-block__item--date-group">',i+=' <div class="m-block__item--date-item">',i+=' <i class="fas fa-calendar-alt"><\/i>'+n[t].StartDate+" <\/div>",i+=" <span>-<\/span>",i+=' <div class="m-block__item--date-item">',i+=' <i class="fas fa-calendar-alt"><\/i>'+n[t].EndDate+"<\/div>",i+="<\/div>",i+='<p class="m-block__item--date-item">'+n[t].MilestoneStatus+"<\/p>",i+='<p class="m-block__item--date-item">'+n[t].UserName+"<\/p>",i+='<p class="m-block__item--date-item" id="'+n[t].MilestoneId+'DisplaySubMilestone" hidden> '+n[t].DisplaySubMilestone+"<\/p>",i+='<div class="m-block__item--content-infoicon">',i+="<span>Last modified on "+n[t].ModifiedDate+"<\/span>",JSON.parse(n[t].ShowProjectDetails)&&(i+='<i class="fas fa-comment-alt" onclick="EditeMyMilestone('+n[t].ProjectId+", '"+n[t].StartDate+" cre', '"+n[t].EndDate+"', '"+n[t].MilestoneStatus+"', '"+n[t].DisplaySubMilestone+"', '"+n[t].MilestoneId+"', '"+n[t].SlNo+"', '"+n[t].PMUVersion+"', '"+n[t].MilestoneName+'\')" title="Project Details"><\/i>'),i+="<\/div>",i+="<\/div>",i+="<\/div>",i+="<\/div>";else alert("No Records to View");$("#cardContainer").append(i)}})}function isWeekend(n){var t=n.getDay();return[0,6].indexOf(t)===-1}function EditeMyMilestone(n,t,i,r,u,f,e,o,s,h,c,l,a){var y,p,v,s,w;DisplaySubGridValue=u.trim();y="";p="";i=i.trim();prevEndDate=i;HubForSave=l;$("#Versionchange").hide();$("#SlNo").val(e);$("#PMUVersion").val(o);$("#MilestoneName").val(s);$(".prj-header").text(l+" - ("+h+") "+c);$(".DisplayCompletedDate").hide();$(".display-extended-date").hide();a=="1"?(ExtendStartDate="",v="",ExtendStartDate=new Date(i),ExtendStartDate.setDate(ExtendStartDate.getDate()+1),ExtendStartDate.getDay()==6&&ExtendStartDate.setDate(ExtendStartDate.getDate()+1),ExtendStartDate.getDay()==0&&ExtendStartDate.setDate(ExtendStartDate.getDate()+1),v=new Date(i),v.getDay()==6&&v.setDate(v.getDate()+1),v.getDay()==0&&v.setDate(v.getDate()+1),$("#ExtendedDate").datepicker("destroy"),$("#ExtendedDate").datepicker({dateFormat:"dd/mm/yy",showButtonPanel:!0,showOtherMonths:!0,autoclose:!0,minDate:new Date(ExtendStartDate),beforeShowDay:function(n){return[isWeekend(n),""]}}),$("#extended-remarks").val(""),$("#need-extended-remarks").html(""),$("#ExtendedDate").val(""),$("#need-extended-date").html(""),$("#ActualCompletedDate").datepicker("destroy"),$("#ActualCompletedDate").datepicker({dateFormat:"dd/mm/yy",minDate:new Date(t),maxDate:new Date(v),showButtonPanel:!0,showOtherMonths:!0,autoclose:!0,beforeShowDay:function(n){return[isWeekend(n),""]}}),$("#ActualCompletedDate").datepicker("setDate",new Date(v)),$("#Remarks").val(""),$("#Remarkserror").html("")):(ExtendStartDate="",v="",ExtendStartDate=new Date(i),ExtendStartDate.setDate(ExtendStartDate.getDate()+1),v=new Date(i),$("#ExtendedDate").datepicker("destroy"),$("#ExtendedDate").datepicker({dateFormat:"dd/mm/yy",showButtonPanel:!0,showOtherMonths:!0,autoclose:!0,minDate:new Date(ExtendStartDate)}),$("#extended-remarks").val(""),$("#need-extended-remarks").html(""),$("#ExtendedDate").val(""),$("#need-extended-date").html(""),$("#ActualCompletedDate").datepicker("destroy"),$("#ActualCompletedDate").datepicker({dateFormat:"dd/mm/yy",minDate:new Date(t),maxDate:new Date(v),showButtonPanel:!0,showOtherMonths:!0,autoclose:!0}),$("#ActualCompletedDate").datepicker("setDate",new Date(v)),$("#Remarks").val(""),$("#Remarkserror").html(""));s="";cardddetailsProjectId=n;cardddetailsmilestoneid=f;cardddetailstatus=r;r==" Completed "&&(r="Completed");pid=n;milestoneIdforchangestatus=f;w=$("#milestone").val();$.ajax({url:ROOT+"ProjectTracker/MileStoneBoard",data:{ProjectID:parseInt(n),DisplaySubMilestone:DisplaySubGridValue},type:"POST",success:function(n){for(var u=0;u<n.length;u++)n[u].MilestoneId==f&&(s=n[u].MilestoneName,y=n[u].flag,Requestflag=n[u].flag,p=n[u].Remarks);$("#RoleId").val()=="3"?y=="Pending For Approval"?($("#btnSubmit").hide(),$(".-cancel").hide()):($("#btnSubmit").show(),$(".-cancel").show()):y=="Approved"||y=="Rejected"||y==null||y==""?($("#btnApprove").hide(),$("#btnReject").hide(),$("#btnSubmit").show(),$("#Remarks").val("")):($("#btnApprove").show(),$("#btnReject").show(),$("#btnSubmit").hide(),$("#Remarks").val(p));r=="Completed";prevEndDate=moment(i).format("DD/MM/YYYY");$("#milestone").val($("#MilestoneName").val());$("#StartDate").val(moment(t).format("DD/MM/YYYY"));$("#EndDate").val(prevEndDate);$("#EndDate").attr("data-previousvalue",prevEndDate);$("#selectedendDate").val(moment(i).format("DD/MM/YYYY"));$("#addModal").modal("show")},error:function(n){alert(n.statusText)}})}function cardedit(){var u=parseInt(pid),n="",t="",f=cardddetailsmilestoneid,i=$("#ExtendedDate").val(),e=$("#ActualCompletedDate").val(),c=$('input[name="AccepptMailtrigger"]:checked').val(),l=$('input[name="AccepptVersionCreation"]:checked').val(),o=$("#AccepptMailtrigger").is(":checked")?!0:!1,s=$("#AccepptVersionCreation").is(":checked")?!0:!1,h=$("#Version").val(),r;if($("#AccepptVersionCreation").is(":checked")){if($("#Version").val()=="")return $("#VersionError").text("Please enter the Version"),errorflag=!1,!1;$("#VersionError").text(" ")}if(CompletedStatus=="Completed"){if(e=="")return $(".need-completed-date").html("Please select Completion Date"),errorflag=!1,!1;if($(".need-completed-date").html(""),errorflag=!0,flag="",n=$("#Remarks").val().trim(),n.length==0)return $("#Remarkserror").html("Please enter the remarks"),errorflag=!1,!1;errorflag=!0}else{if(t=$("#extended-remarks").val().trim(),t.length==0||i.length==0)return i.length==0?$(".need-extended-date").html("Please select the extended date"):$(".need-extended-date").html(""),t.length==0?$(".need-extended-remarks").html("Please enter the remarks"):$(".need-extended-remarks").html(""),!1;errorflag=!0;flag=""}$("#RoleId").val()=="3"&&userconfirmation&&(CompletedStatus=="Completed"?($("#UserConfirmationforCompleteMilestone").modal("show"),userrequest=!1):errorflag||($("#UserConfirmationforenddate").modal("show"),userrequest=!1));HubId=HubList.filter(n=>n.HubName==HubForSave).map(n=>n.HubId);r=CompletedStatus=="Completed"?{ProjectId:u,MilestoneId:f,StartDate:moment($("#StartDate").val(),"DD/MM/YYYY").format("YYYY-MM-DD"),EndDate:moment($("#EndDate").val(),"DD/MM/YYYY").format("YYYY-MM-DD"),MilestoneStatus:CompletedStatus,ActualCompletedDate:e,Remarks:n,AccepptMailtrigger:o,AccepptVersionCreation:s,Buttoneflag:Buttoneflag,NewVersionName:h,Remarks:n,SlNo:$("#SlNo").val(),PMUVersion:$("#PMUVersion").val(),CompletedStatus:CompletedStatus,flag:flag,PreviousEndDate:moment($("#EndDate").attr("data-previousvalue"),"DD/MM/YYYY").format("YYYY-MM-DD"),VersionRemarks:$("#VersionRemarks").val(),HubId:HubId}:{ProjectId:u,MilestoneId:f,StartDate:moment($("#StartDate").val(),"DD/MM/YYYY").format("YYYY-MM-DD"),EndDate:moment($("#selectedendDate").val(),"DD/MM/YYYY").format("YYYY-MM-DD"),MilestoneStatus:CompletedStatus,ExtendedDate:i,Remarks:n,AccepptMailtrigger:o,AccepptVersionCreation:s,Buttoneflag:Buttoneflag,NewVersionName:h,Remarks:t,SlNo:$("#SlNo").val(),PMUVersion:$("#PMUVersion").val(),CompletedStatus:CompletedStatus,flag:flag,PreviousEndDate:moment($("#EndDate").attr("data-previousvalue"),"DD/MM/YYYY").format("YYYY-MM-DD"),VersionRemarks:$("#VersionRemarks").val(),HubId:HubId};r!=null&&errorflag&&Approvebuttonclick&&userrequest&&$.ajax({type:"post",url:ROOT+"ProjectTracker/New_EditPMUMapping",data:{Milestone:r},dataType:"json",success:function(n){$("#addModal").modal("hide");$("#dependentMilestones").modal("hide");n.toLowerCase().includes("updated")?window.location.href=ROOT+"ProjectTracker/MileStoneBoard":alert(n)},error:function(n){alert(n.statusText)}})}function CreateJqGrid(n){$.jgrid.gridUnload("#jqgrid");$("#jqgrid").jqGrid({url:"",datatype:"local",data:n,mtype:"GET",colModel:models,loadonce:!0,viewrecords:!0,sortable:!1,rowNum:1e4,gridview:!0,scroll:1,pager:"#pager",userDataOnFooter:!0,gridComplete:function(){var t=$("#jqgrid tbody tr"),r=$("#jqgrid tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))},loadComplete:function(){$(".submilestoneexist").each(function(n,t){if(console.log(t.textContent),t.textContent!="True"){var i=$(t).parent().find("td.sgcollapsed");$(i).unbind("click").html("")}});var n=$("#jqgrid"),t=n.jqGrid("getCol","Amount",!1,"sum");n.jqGrid("footerData","set",{OrderQtyInPallets:"Total Amount $:"});n.jqGrid("footerData","set",{Amount:parseFloat(n.jqGrid("getCol","Amount",!1,"sum")).toFixed(2)});$(".tamounteuro").text(parseFloat(t).toFixed(2));parseInt(t)!==0?$(".tamountdlr").text(parseFloat(1/t).toFixed(2)):0}})}function dependentMilestoneDetails(n,t){SelecteDprojectId=n;$.ajax({"async":!0,type:"post",url:ROOT+"ProjectTracker/DependentMilestoneList",data:{ProjectId:n,MilestoneId:t},dataType:"json",success:function(i){dependentMilestoneDetailsList=i;EndDateExtensionflag?displayUpdatedatesdetails(t,n):(SubMilestoneDataList(n),$("#dependentMilestones").modal("show"),$("#jqgrid").jqGrid("clearGridData",!0),jQuery("#jqgrid").jqGrid("setGridParam",{data:i}),jQuery("#jqgrid").trigger("reloadGrid"),CreateJqGrid(i),dependentMilestonedisplay?($("#jqgrid").jqGrid("hideCol","UpdatedStartDate"),$("#jqgrid").jqGrid("hideCol","UpdatedEndDate")):($("#jqgrid").jqGrid("showCol","UpdatedStartDate"),$("#jqgrid").jqGrid("showCol","UpdatedEndDate")))},error:function(n){alert(n.statusText)}})}function SubMilestoneDataList(n){var i=dependentMilestoneDetailsList.filter(n=>n.SubmilestoneExit=="True"),t,r;if(DependentSub_Milestones=[],i.length>0)for(t=0;t<i.length;t++)r=i[t].SequenceNo,console.log(r),$.ajax({"async":!1,type:"Get",url:ROOT+"Master/GetProjectSummarySubMilestoneDetails",data:{ProjectId:n,SequenceNo:r},dataType:"json",success:function(n){DependentSub_Milestones=$.merge(DependentSub_Milestones,n)},error:function(n){alert(n.statusText)}})}function displayUpdatedatesdetails(n,t){var o,l,r,u,s,h,i,c,e,f;if(DependentSub_Milestones=[],SubMilestoneDataList(t),o="",DisplaySubGridValue=="True"&&DependentSub_Milestones.length>0&&(i=DependentSub_Milestones.findIndex(t=>t.SubMilestoneId==n),DependentSub_Milestones[i].UpdatedStartDate=DependentSub_Milestones[i].StartDate,DependentSub_Milestones[i].UpdatedEndDate=UpdatedEndDate_User,o=SubMilestoneDatesDisplay(i+1,DependentSub_Milestones[i].SequenceNo)),dependentMilestoneDetailsList.length>0)for(DisplaySubGridValue==""?(i=dependentMilestoneDetailsList.findIndex(t=>t.MilestoneId==n),dependentMilestoneDetailsList[i].UpdatedStartDate=dependentMilestoneDetailsList[i].StartDate,dependentMilestoneDetailsList[i].UpdatedEndDate=UpdatedEndDate_User,l=dependentMilestoneDetailsList[i].SequenceNo):i=o,r=i+1;r<dependentMilestoneDetailsList.length;r++)u=dependentMilestoneDetailsList[r].SetRelation,s=u!=""&&u!=undefined&&u!=null?dependentMilestoneDetailsList.findIndex(n=>n.SequenceNo==u):dependentMilestoneDetailsList.findIndex(n=>n.SequenceNo==dependentMilestoneDetailsList[i].SequenceNo),h=dependentMilestoneDetailsList[s].UpdatedEndDate,EndDate=new Date(h.split("/").reverse().join("-")),StartDate=moment(EndDate).add(1,"days").format("DD/MM/YYYY"),dependentMilestoneDetailsList[r].UpdatedStartDate=StartDate,dependentMilestoneDetailsList[r].SubmilestoneExit=="True"?(i=DependentSub_Milestones.findIndex(n=>n.SequenceNo==dependentMilestoneDetailsList[r].SequenceNo),DependentSub_Milestones[i].UpdatedStartDate=StartDate,e=new Date(StartDate.split("/").reverse().join("-")),f=moment(e).add(parseInt(DependentSub_Milestones[i].Duration)-1,"days").format("DD/MM/YYYY"),DependentSub_Milestones[i].UpdatedEndDate=f,c=new Date(f.split("/").reverse().join("-")),StartDate=moment(c).add(1,"days").format("DD/MM/YYYY"),DependentSub_Milestones[i+1].UpdatedStartDate=StartDate,SubMilestoneDatesDisplay(i+1,dependentMilestoneDetailsList[r].SequenceNo)):(e=new Date(StartDate.split("/").reverse().join("-")),f=moment(e).add(parseInt(dependentMilestoneDetailsList[r].Duration)-1,"days").format("DD/MM/YYYY"),dependentMilestoneDetailsList[r].UpdatedEndDate=f);$("#dependentMilestones").modal("show");$("#jqgrid").jqGrid("clearGridData",!0);jQuery("#jqgrid").jqGrid("setGridParam",{data:dependentMilestoneDetailsList});jQuery("#jqgrid").trigger("reloadGrid");CreateJqGrid(dependentMilestoneDetailsList);$("#jqgrid").jqGrid("showCol","UpdatedStartDate");$("#jqgrid").jqGrid("showCol","UpdatedEndDate")}function SubMilestoneDatesDisplay(n,t){for(var r,e,o,s,h,u,i=n;i<DependentSub_Milestones.length;i++)DependentSub_Milestones[i].SequenceNo==t&&(r=DependentSub_Milestones[i].SetRelation,e=r!=""&&r!="0"&&r!=undefined?DependentSub_Milestones.findIndex(n=>n.SubMilestoneId==r):DependentSub_Milestones.findIndex(n=>n.SubMilestoneId==DependentSub_Milestones[i].SubMilestoneId),o=DependentSub_Milestones[e].UpdatedEndDate,EndDate=new Date(o.split("/").reverse().join("-")),StartDate=moment(EndDate).add(1,"days").format("DD/MM/YYYY"),DependentSub_Milestones[i].UpdatedStartDate=StartDate,s=new Date(StartDate.split("/").reverse().join("-")),h=moment(s).add(parseInt(DependentSub_Milestones[i].Duration)-1,"days").format("DD/MM/YYYY"),DependentSub_Milestones[i].UpdatedEndDate=h);var f=DependentSub_Milestones.filter(n=>n.SequenceNo==t),v=f[f.length-1].SetRelation,c=f.filter(n=>n.SetRelation==v),l=[];$.each(c,function(n){var t=c[n].UpdatedEndDate,i;t!=""&&t!=null&&(i=new Date(t.split("/").reverse().join("-")),l.push(new Date(i)))});u=new Date(Math.max.apply(null,l));u=moment(u).format("DD/MM/YYYY");var a=new Date(f[0].UpdatedStartDate.split("/").reverse().join("-")),y=new Date(u.split("/").reverse().join("-")),p=y.getTime()-a.getTime(),w=Math.ceil(p/864e5);return totalDuration=w+1,parent_Index=dependentMilestoneDetailsList.findIndex(n=>n.SequenceNo==t),dependentMilestoneDetailsList[parent_Index].UpdatedStartDate=moment(a).format("DD/MM/YYYY"),dependentMilestoneDetailsList[parent_Index].UpdatedEndDate=u,parent_Index}function GetSearchedData(n,t,i){$.ajax({type:"POST",url:ROOT+"ProjectTracker/GetMyMileStoneSearchedData",data:{HubId:n,ProjectId:t,StatusId:i},dataType:"json",success:function(n){data=n;var t=1,i=1,r=1,u=1;$(".hide_section").empty();$(".count_num").empty();$("#cardscount").empty();$("#cardscount").html("<b>"+n.length+"<\/b>");$.each(n,function(f,e){var c,l,o;if(e.UserName!=null&&(c=e.UserName.lastIndexOf(" "),l="",c!=-1&&(l=e.UserName[c+1]),o=(e.UserName[0]+l).toUpperCase()),n[f].MilestoneStatus=="Completed"){$(".count_completed").text(t);var o=e.UserName!=null&&e.UserName!=""?e.UserName.substring(0,2).toUpperCase():" ",s=`<div class="hide_section">
        <div class="open_list">
            <div>
                <div class="list_card">
                    <div class="hub_project">
                         `+e.Hub+` - (`+e.ProjectCode+`)`+e.ProjectName+`
                    </div>
                    <div class="task_list">
                       `+e.MilestoneName+`
                    </div>
                    <div class="project_date">
                        <span>
                            <i class="fa fa-calendar"></i>`+e.StartDate+`
                        </span>
                        <span>-</span>
                        <span>
                            <i class="fa fa-calendar"></i>`+e.EndDate+`
                        </span>
                    </div>
                    <div class="status">
                        <span class="text-info">`+e.MilestoneStatus+`</span>
                    </div>
                    <div class="user_name_list">
                        <span class="user_profile">`+o+`</span><span class="">`+e.UserName+`</span>
                    </div>
                    <div class="last_modified">
                        <p class="mb-0">
                           `+e.ModifiedDate+`
                        </p>
                    </div>
                </div>
            </div>
            </div>
        </div>`,h=$(s);$(".Completed").append(h);t=t+1}else if(n[f].MilestoneStatus=="OverDue"){$(".count_overdue").text(i);var o=e.UserName!=null&&e.UserName!=""?e.UserName.substring(0,2).toUpperCase():" ",s=`<div class="hide_section">
        <div class="open_list">
            <div>
                <div class="list_card">
                    <div class="hub_project">
                        `+e.Hub+` - (`+e.ProjectCode+`)`+e.ProjectName+`
                    </div>
                    <div class="task_list">
                       `+e.MilestoneName+`
                    </div>
                    <div class="project_date">
                        <span>
                            <i class="fa fa-calendar"></i>`+e.StartDate+`
                        </span>
                        <span>-</span>
                        <span>
                            <i class="fa fa-calendar"></i>`+e.EndDate+`
                        </span>
                    </div>
                    <div class="status">
                        <span class="text-info">`+e.MilestoneStatus+`</span>
                    </div>
                    <div class="user_name_list">
                        <span class="user_profile">`+o+`</span><span class="">`+e.UserName+`</span>
                    </div>
                    <div class="last_modified">
                        <p class="mb-0">
                           `+e.ModifiedDate+`
                        </p>
                    </div>
                                 
                    ${e.IsAlreadyRequest==0?`
                    <div class="comments">
                        <span title="Project Details" onclick="EditeMyMilestone('${e.ProjectId}', '${e.StartDate}', '${e.EndDate}', '${e.MilestoneStatus}', '${e.DisplaySubMilestone}', ${e.MilestoneId}, ${e.SlNo}, '${e.PMUVersion}', '${e.MilestoneName}',
                        '${e.ProjectCode}', '${e.ProjectName}', '${e.Hub}', '${e.IsWeekendExcluded}')">
                            <i class="fa fa-comment"></i>
                        </span>
                    </div>
                `:""} 
                </div>
            </div>
        </div>
        </div>`,h=$(s);$(".overdue_list").append(h);i=i+1}else if(n[f].MilestoneStatus=="In Progress"){$(".count_inprogress").text(r);var o=e.UserName!=null&&e.UserName!=""?e.UserName.substring(0,2).toUpperCase():"",s=`<div class="hide_section">
            <div class="open_list">
            <div>
                <div class="list_card">
                    <div class="hub_project">
                        `+e.Hub+` - (`+e.ProjectCode+`)`+e.ProjectName+`
                    </div>
                    <div class="task_list">
                       `+e.MilestoneName+`
                    </div>
                    <div class="project_date">
                        <span>
                            <i class="fa fa-calendar"></i>`+e.StartDate+`
                        </span>
                        <span>-</span>
                        <span>
                            <i class="fa fa-calendar"></i>`+e.EndDate+`
                        </span>
                    </div>
                    <div class="status">
                        <span class="text-info">`+e.MilestoneStatus+`</span>
                    </div>
                    <div class="user_name_list">
                        <span class="user_profile">`+o+`</span><span class="">`+e.UserName+`</span>
                    </div>
                    <div class="last_modified">
                        <p class="mb-0">
                           `+e.ModifiedDate+`
                        </p>
                    </div>
                    ${e.IsAlreadyRequest==0?`
                    <div class="comments">
                        <span title="Project Details" onclick="EditeMyMilestone('${e.ProjectId}', '${e.StartDate}', '${e.EndDate}', '${e.MilestoneStatus}', '${e.DisplaySubMilestone}', ${e.MilestoneId}, ${e.SlNo}, '${e.PMUVersion}', '${e.MilestoneName}',
                        '${e.ProjectCode}', '${e.ProjectName}', '${e.Hub}', '${e.IsWeekendExcluded}')">
                            <i class="fa fa-comment"></i>
                        </span>
                    </div>
                `:""} 
                </div>
            </div>
            </div>
        </div>`,h=$(s);$(".list_inProgress").append(h);r=r+1}else if(n[f].MilestoneStatus=="Open"){$(".count_open").text(u);var o=e.UserName!=null&&e.UserName!=""?e.UserName.substring(0,2).toUpperCase():"",s=`<div class="hide_section">
        <div class="open_list">
            <div>
                <div class="list_card">
                    <div class="hub_project">
                        `+e.Hub+` - (`+e.ProjectCode+`)`+e.ProjectName+`
                    </div>
                    <div class="task_list">
                       `+e.MilestoneName+`
                    </div>
                    <div class="project_date">
                        <span>
                            <i class="fa fa-calendar"></i>`+e.StartDate+`
                        </span>
                        <span>-</span>
                        <span>
                            <i class="fa fa-calendar"></i>`+e.EndDate+`
                        </span>
                    </div>
                    <div class="status">
                        <span class="text-info">`+e.MilestoneStatus+`</span>
                    </div>
                    <div class="user_name_list">
                        <span class="user_profile">`+o+`</span><span class="">`+e.UserName+`</span>
                    </div>
                    <div class="last_modified">
                        <p class="mb-0">
                           `+e.ModifiedDate+`
                        </p>
                    </div>
                     ${e.IsAlreadyRequest==0?`
                    <div class="comments">
                        <span title="Project Details" onclick="EditeMyMilestone('${e.ProjectId}', '${e.StartDate}', '${e.EndDate}', '${e.MilestoneStatus}', '${e.DisplaySubMilestone}', ${e.MilestoneId}, ${e.SlNo}, '${e.PMUVersion}', '${e.MilestoneName}',
                        '${e.ProjectCode}', '${e.ProjectName}', '${e.Hub}', '${e.IsWeekendExcluded}')">
                            <i class="fa fa-comment"></i>
                        </span>
                    </div>
                `:""} 
                </div>
            </div>
            </div>
        </div>`,h=$(s);$(".open_list_progress").append(h);u=u+1}})}})}function SearchMilestone(){var n="search";$(".m-block__item").parent(".col-lg-3").remove();filter=$("#SearchProject").val().toLowerCase();$.trim(filter);jQuery.inArray(filter,StatusList)!=-1?MyMilestone(filteruserid,"",$.trim(filter),n,email):MyMilestone(filteruserid,$.trim(filter),"",n,email)}var pid=$("#ProjectId").val(),status="",milestoneIdforchangestatus="",filter=$("#SearchProject").val(),cardddetailsProjectId="",cardddetailsmilestoneid="",cardddetailstatus="",cardrelation="",email="",dependentMilestonedisplay="",role="",selectedval="n",StatusList=[],data=[],prevEndDate="",errorflag="",ValidationAlertDisplay=!0,Approvebuttonclick=!0,Buttoneflag="",Requestflag="",userrequest=!0,userconfirmation=!0,DisplaySubGridValue="",SelecteDprojectId="",filteruserid="",dependentMilestoneDetailsList=[],SubmilestoneData=[],UpdatedEndDate_User="",DependentSub_Milestones=[],UpdatedStartDate_User="",EndDateExtensionflag="",VersionReamrks="",HubForSave="",HubList=JSON.parse($("#getHubList").val()),HubId=0,cardDetailsHub="",ExtendEndDate,ExtendStartDate,filterstats,CompletedStatus,white,bgcolor;$(document).ready(function(){$("#Versionchange").hide();$("#loader").css("visibility","hidden");$("#ProjectId").hide();$(".projectName_error").hide();$(".hubName_error").hide();$("#projectNameList").eq(1).remove();$(".select-multiple").multiselect({includeSelectAllOption:!0,buttonWidth:220,enableCaseInsensitiveFiltering:!0,enableFiltering:!0,selectAllValue:"0"});$("#projectNameList").hide();StatusList=["open","notstarted","overdue"];$("#cardscount").html("<b>"+$("#Countlist").val()+"<\/b>")});var GetData=$.parseJSON($("#JsonData").val()),a=1,b=1,c=1,d=1;(GetData!=undefined||GetData!=null)&&$(".project-hub-name").text(GetData[0].Hub+"-("+GetData[0].ProjectCode+")"+GetData[0].ProjectName);$.each(GetData,function(n,t){var f,e,i;if(t.UserName!=null&&(f=t.UserName.lastIndexOf(" "),e="",f!=-1&&(e=t.UserName[f+1]),i=(t.UserName[0]+e).toUpperCase()),GetData[n].MilestoneStatus=="Completed"){$(".count_completed").text(a);var i=t.UserName!=null&&t.UserName!=""?t.UserName.substring(0,2).toUpperCase():" ",r=`<div class="hide_section">
        <div class="open_list">
            <div>
                <div class="list_card">
                    <div class="hub_project">
                         `+t.Hub+` - (`+t.ProjectCode+`)`+t.ProjectName+`
                    </div>
                    <div class="task_list">
                       `+t.MilestoneName+`
                    </div>
                    <div class="project_date">
                        <span>
                            <i class="fa fa-calendar"></i>`+t.StartDate+`
                        </span>
                        <span>-</span>
                        <span>
                            <i class="fa fa-calendar"></i>`+t.EndDate+`
                        </span>
                    </div>
                    <div class="status">
                        <span class="text-info">`+t.MilestoneStatus+`</span>
                    </div>
                    <div class="user_name_list">
                        <span class="user_profile">`+i+`</span><span class="">`+t.UserName+`</span>
                    </div>
                    <div class="last_modified">
                        <p class="mb-0">
                           `+t.ModifiedDate+`
                        </p>
                    </div>
                </div>
            </div>
            </div>
        </div>`,u=$(r);$(".Completed").append(u);a=a+1}else if(GetData[n].MilestoneStatus=="OverDue"){$(".count_overdue").text(b);var i=t.UserName!=null&&t.UserName!=""?t.UserName.substring(0,2).toUpperCase():" ",r=`<div class="hide_section">
        <div class="open_list">
            <div>
                <div class="list_card">
                    <div class="hub_project">
                        `+t.Hub+` - (`+t.ProjectCode+`)`+t.ProjectName+`
                    </div>
                    <div class="task_list">
                       `+t.MilestoneName+`
                    </div>
                    <div class="project_date">
                        <span>
                            <i class="fa fa-calendar"></i>`+t.StartDate+`
                        </span>
                        <span>-</span>
                        <span>
                            <i class="fa fa-calendar"></i>`+t.EndDate+`
                        </span>
                    </div>
                    <div class="status">
                        <span class="text-info">`+t.MilestoneStatus+`</span>
                    </div>
                    <div class="user_name_list">
                        <span class="user_profile">`+i+`</span><span class="">`+t.UserName+`</span>
                    </div>
                    <div class="last_modified">
                        <p class="mb-0">
                           `+t.ModifiedDate+`
                        </p>
                    </div>
                    ${t.IsAlreadyRequest==0?`
                    <div class="comments">
                        <span title="Project Details" onclick="EditeMyMilestone('${t.ProjectId}', '${t.StartDate}', '${t.EndDate}', '${t.MilestoneStatus}', '${t.DisplaySubMilestone}', ${t.MilestoneId}, ${t.SlNo}, '${t.PMUVersion}', '${t.MilestoneName}',
                        '${t.ProjectCode}', '${t.ProjectName}', '${t.Hub}', '${t.IsWeekendExcluded}')">
                            <i class="fa fa-comment"></i>
                        </span>
                    </div>
                `:""}    
                </div>
            </div>
        </div>
        </div>`,u=$(r);$(".overdue_list").append(u);b=b+1}else if(GetData[n].MilestoneStatus=="In Progress"){$(".count_inprogress").text(c);var i=t.UserName!=null&&t.UserName!=""?t.UserName.substring(0,2).toUpperCase():"",r=`<div class="hide_section">
            <div class="open_list">
            <div>
                <div class="list_card">
                    <div class="hub_project">
                        `+t.Hub+` - (`+t.ProjectCode+`)`+t.ProjectName+`
                    </div>
                    <div class="task_list">
                       `+t.MilestoneName+`
                    </div>
                    <div class="project_date">
                        <span>
                            <i class="fa fa-calendar"></i>`+t.StartDate+`
                        </span>
                        <span>-</span>
                        <span>
                            <i class="fa fa-calendar"></i>`+t.EndDate+`
                        </span>
                    </div>
                    <div class="status">
                        <span class="text-info">`+t.MilestoneStatus+`</span>
                    </div>
                    <div class="user_name_list">
                        <span class="user_profile">`+i+`</span><span class="">`+t.UserName+`</span>
                    </div>
                    <div class="last_modified">
                        <p class="mb-0">
                           `+t.ModifiedDate+`
                        </p>
                    </div>
                    ${t.IsAlreadyRequest==0?`
                    <div class="comments">
                        <span title="Project Details" onclick="EditeMyMilestone('${t.ProjectId}', '${t.StartDate}', '${t.EndDate}', '${t.MilestoneStatus}', '${t.DisplaySubMilestone}', ${t.MilestoneId}, ${t.SlNo}, '${t.PMUVersion}', '${t.MilestoneName}',
                        '${t.ProjectCode}', '${t.ProjectName}', '${t.Hub}','${t.IsWeekendExcluded}')">
                            <i class="fa fa-comment"></i>
                        </span>
                    </div>
                `:""}
                </div>
            </div>
            </div>
        </div>`,u=$(r);$(".list_inProgress").append(u);c=c+1}else if(GetData[n].MilestoneStatus=="Open"){$(".count_open").text(d);var i=t.UserName!=null&&t.UserName!=""?t.UserName.substring(0,2).toUpperCase():"",r=`<div class="hide_section">
        <div class="open_list">
            <div>
                <div class="list_card">
                    <div class="hub_project">
                        `+t.Hub+` - (`+t.ProjectCode+`)`+t.ProjectName+`
                    </div>
                    <div class="task_list">
                       `+t.MilestoneName+`
                    </div>
                    <div class="project_date">
                        <span>
                            <i class="fa fa-calendar"></i>`+t.StartDate+`
                        </span>
                        <span>-</span>
                        <span>
                            <i class="fa fa-calendar"></i>`+t.EndDate+`
                        </span>
                    </div>
                    <div class="status">
                        <span class="text-info">`+t.MilestoneStatus+`</span>
                    </div>
                    <div class="user_name_list">
                        <span class="user_profile">`+i+`</span><span class="">`+t.UserName+`</span>
                    </div>
                    <div class="last_modified">
                        <p class="mb-0">
                           `+t.ModifiedDate+`
                        </p>
                    </div>
                    ${t.IsAlreadyRequest==0?`
                    <div class="comments">
                        <span title="Project Details" onclick="EditeMyMilestone('${t.ProjectId}', '${t.StartDate}', '${t.EndDate}', '${t.MilestoneStatus}', '${t.DisplaySubMilestone}', ${t.MilestoneId}, ${t.SlNo}, '${t.PMUVersion}', '${t.MilestoneName}',
                        '${t.ProjectCode}', '${t.ProjectName}', '${t.Hub}', '${t.IsWeekendExcluded}')">
                            <i class="fa fa-comment"></i>
                        </span>
                    </div>
                `:""}
                </div>
            </div>
            </div>
        </div>`,u=$(r);$(".open_list_progress").append(u);d=d+1}});$("[data-multiselect]").multiselect({includeSelectAllOption:!0,buttonWidth:220,enableCaseInsensitiveFiltering:!0,enableFiltering:!0,numberDisplayed:1});$(".datepicker").datepicker({format:"dd/mm/yyyy",todayHighlight:!0,autoclose:!0});$(".c-filter__filter").click(function(){$("#page-wrapper").addClass("custom-page-wrapper")});$("#milestone").change(function(){var n=$("#milestone").val(),t=parseInt(pid);$.ajax({type:"POST",url:ROOT+"ProjectTracker/DatePicker",data:{milestoneid:n,ProjectId:t},dataType:"json",success:function(n){$("#StartDate").val(n[0].StartDate);$("#EndDate").val(n[0].EndDate)}})});ExtendEndDate="";ExtendStartDate="";$(".status").click(function(){EndDateExtensionflag=!1;CompletedStatus=$(this).text();var n=$("#SlNo").val(),t=$("#MilestoneName").val();HubId=HubList.filter(n=>n.HubName==HubForSave).map(n=>n.HubId);CompletedStatus=="Completed"?($(".DisplayCompletedDate").show(),$(".display-extended-date").hide(),$.ajax({url:ROOT+"ProjectTracker/AlertforCompletthemilestone",data:{ProjectId:parseInt(cardddetailsProjectId),MilestoneId:parseInt(cardddetailsmilestoneid),DisplaySubMilestone:DisplaySubGridValue,SlNo:n,Hub:HubId},type:"POST",success:function(n){n.length>0?($(".DisplayCompletedDate").hide(),$("#displaySpanmsg").html("<b>Dependent milestone is not Completed<b/>"),$("#btndepent").removeAttr("hidden"),$("#btnok").hide(),$("#BtnCanceldependent").hide(),$("#milestone").val(t),dependentMilestonedisplay=!0,CompletedStatus=cardddetailstatus,CreateJqGrid(n),$("#dependentMilestones").modal("show"),dependentMilestonedisplay?($("#jqgrid").jqGrid("hideCol","UpdatedStartDate"),$("#jqgrid").jqGrid("hideCol","UpdatedEndDate")):($("#jqgrid").jqGrid("showCol","UpdatedStartDate"),$("#jqgrid").jqGrid("showCol","UpdatedEndDate"))):$(".DisplayCompletedDate").show()},error:function(n){alert(n.statusText)}})):CompletedStatus=="Date Extension"&&($(".DisplayCompletedDate").hide(),$(".display-extended-date").show())});$("#myUserInput").on("keyup",function(){var n=$(this).val().toLowerCase();$("#myUserList li").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(n)>-1)})});$("body").addClass("menuitemshow");filterstats="";$(".checkboxlist").change(function(){var t,i,r,n;ProjectName=$("#ProjectId option:Selected").text();projectId=$("#ProjectId").children(":selected").attr("value");$(".m-block__item").parent(".col-lg-3").remove();t=$("input[name=milestone]:checked").map(function(){return this.value}).get().join(",");i=$("input[name=UserList]:checked").map(function(){return this.value}).get().join(",");filterstats=$("input[name=milestoneStatus]:checked").map(function(){return this.value}).get().join(",");console.log(t);r=$("input[name=milestone]:checked").map(function(){return this.value}).get();r.length>0||filterstats!=""||i!=""?filter==""?(n="list",MyMilestone(t,i,filterstats,ProjectName,projectId,n,email)):(n="search",MyMilestone(t,i,filterstats,filter,"",n,email)):(n="list",MyMilestone(t,i,filterstats,ProjectName,projectId,n,email))});$("#Cancel").click(function(n){$("input[name=milestone]").prop("checked",!1);$("input[name=milestoneStatus]").prop("checked",!1);$("#page-wrapper").removeClass("custom-page-wrapper");$("Remarks").val("");n.preventDefault();location.reload();$("div.id_100 select").select2().val(projectId).change()});CompletedStatus="";white=!1;$("#btnSubmit").click(function(){var i,n,t;Approvebuttonclick=!0;Buttoneflag="Submitted";var r=$("#SlNo").val(),u=$("#PMUVersion").val(),f=parseInt(pid),e=cardddetailsmilestoneid;if(HubId=HubList.filter(n=>n.HubName==HubForSave).map(n=>n.HubId),CompletedStatus=="Completed"){if(i=$("#Remarks").val().trim(),i.length==0)return $("#Remarkserror").html("Please enter the remarks"),!1}else if(n=$("#ExtendedDate").val().trim(),t=$("#extended-remarks").val().trim(),t.length==0||n.length==0)return n.length==0?$(".need-extended-date").html("Please select the extended date"):$(".need-extended-date").html(""),t.length==0?$(".need-extended-remarks").html("Please enter the remarks"):$(".need-extended-remarks").html(""),!1;$("#RoleId").val()=="3"&&moment($("#EndDate").val(),"DD/MM/YYYY").isSame(moment($("#selectedendDate").val(),"DD/MM/YYYY"))?(flag="Pending For Approval",CompletedStatus!="Completed"?cardedit():cardedit()):(flag="",moment($("#ExtendedDate").val(),"DD/MM/YYYY").isSame(moment($("#selectedendDate").val(),"DD/MM/YYYY"))||CompletedStatus=="Completed"?cardedit():($("#btndepent").attr("hidden",!0),$("#btnok").show(),$("#BtnCanceldependent").show(),$("#displaySpanmsg").html("On Extending end date the dependent milestones date(s) will be updated. Are you sure you want to proceed ?<\/b>"),dependentMilestonedisplay=!1,$.ajax({type:"get",url:ROOT+"ProjectTracker/GetMilestoneRevisedDates",data:{ProjectId:f,MilestoneId:e,SlNo:r,PMUVersion:u,StartDate:$("#StartDate").val(),EndDate:$("#ExtendedDate").val(),Hub:HubId[0]},dataType:"json",success:function(n){dependentMilestoneDetailsList=n;$("#dependentMilestones").modal("show");$("#jqgrid").jqGrid("clearGridData",!0);jQuery("#jqgrid").jqGrid("setGridParam",{data:n});jQuery("#jqgrid").trigger("reloadGrid");CreateJqGrid(n);dependentMilestonedisplay?($("#jqgrid").jqGrid("hideCol","UpdatedStartDate"),$("#jqgrid").jqGrid("hideCol","UpdatedEndDate")):($("#jqgrid").jqGrid("showCol","UpdatedStartDate"),$("#jqgrid").jqGrid("showCol","UpdatedEndDate"))},error:function(n){alert(n.statusText)}})))});$("#btnok").click(function(){Approvebuttonclick=!0;flag="Approved";cardedit()});$("#extended-remarks").keyup(function(){$("#extended-remarks").val()==""?$(".need-extended-remarks").html("Please enter the remarks"):$(".need-extended-remarks").html("")});$("#Remarks").keyup(function(){$("#Remarks").val()==""?$("#Remarkserror").html("Please enter the remarks"):$("#Remarkserror").html("")});$("#ExtendedDate").change(function(){$("#ExtendedDate").val().length==0?$(".need-extended-date").html("Please select the extended date"):$(".need-extended-date").html("")});$("#CompleteMilestone").click(function(){userrequest=!0;userconfirmation=!1;cardedit()});$("#endChangeDate").click(function(){flag="Pending For Approval";userrequest=!0;userconfirmation=!1;cardedit()});$("#EndNoButton").click(function(){$("#UserConfirmationforenddate").modal("hide")});Submodels=[{name:"SequenceNo",label:"Milestone Id",resizable:!0,hidden:!0,ignoreCase:!0},{name:"TaskDescription",resizable:!0,label:"Milestone No",ignoreCase:!0},{name:"SubMilestoneName",resizable:!0,label:"Milestone Name",ignoreCase:!0},{name:"SetRelation",resizable:!0,label:"Set Relation",ignoreCase:!0},{name:"StartDate",label:"Start Date",width:100,resizable:!0,ignoreCase:!0,sortable:!1},{name:"EndDate",resizable:!0,label:"End Date",sorttype:"Date",width:100,ignoreCase:!0,sortable:!1},{name:"UpdatedStartDate",label:"Revised Start Date",width:100,resizable:!0,ignoreCase:!0,sortable:!1},{name:"UpdatedEndDate",resizable:!0,label:"Revised End Date",sorttype:"Date",width:100,ignoreCase:!0,sortable:!1},];models=[{name:"SlNo",label:"Sl No",width:60,align:"center",resizable:!0,ignoreCase:!0,sortable:!1},{name:"TaskDesc",resizable:!0,width:100,label:"Tasks",ignoreCase:!0,sortable:!1},{name:"StartDate",label:"Start Date",width:100,resizable:!0,ignoreCase:!0,sortable:!1},{name:"EndDate",resizable:!0,label:"End Date",sorttype:"Date",width:100,ignoreCase:!0,sortable:!1},{name:"UpdatedStartDate",label:"Revised Start Date",width:100,resizable:!0,ignoreCase:!0,sortable:!1},{name:"UpdatedEndDate",resizable:!0,label:"Revised End Date",sorttype:"Date",width:100,ignoreCase:!0,sortable:!1}];$("#btnApprove").click(function(){Approvebuttonclick=!1;Buttoneflag="Approve";flag="";var i=cardedit(),n=parseInt(pid),t=cardddetailsmilestoneid;UpdatedEndDate_User=$("#EndDate").val();errorflag&&(EndDateExtensionflag=!0,$("#displaySpanmsg").html("On Approving the Proposed end date the dependent milestones date(s) will be updated.Please enter appropriate remarks on approving, Are you sure you want to proceed ?<\/b>"),$("#btndepent").attr("hidden",!0),$("#btnok").show(),$("#BtnCanceldependent").show(),dependentMilestonedisplay=!1,dependentMilestoneDetails(n,t))});$("#btnReject").on("click",function(){Buttoneflag="reject";flag="Rejected";cardedit()});$("#SearchUser").on("click",function(){var n=$("#HubId").val().join(","),t=$("#Project_ID").val().join(","),i=$("#StatusId").val().join(",");GetSearchedData(n,t,i)});$("#SearchProject").on("keydown",function(n){if(n.keyCode!=8||n.key!="Backspace"){var t=$(this).val().trim().toLowerCase();$("#SearchProject").val().trim().length>3&&MyMilestone("",t,"","search",email)}filter=""});$("#Search_btn").on("click",function(){SearchMilestone()});$("#BtnCanceldependent").on("click",function(){$("#dependentMilestones").modal("hide")});$("#AccepptVersionCreation").change(function(){$(this).is(":checked")?$.ajax({type:"post",url:ROOT+"ProjectTracker/GetVersion",data:{ProjectId:cardddetailsProjectId},dataType:"json",success:function(n){console.log("response",n);$("#Version").val(n);$("#VersionError").text("");$("#VersionRemarks").val("");$("#VersionRemarkspop").modal("show");$("#Versionchange").show()},error:function(n){alert(n.statusText)}}):$("#Versionchange").hide()});$("#VersionAcept").click(function(){var n=$("#Version").val();n.length==0?($("#VersionError").text("Please enter the Version"),$("#Versionchange").show()):$("#Versionchange").hide()});$("#btnCancel").click(function(){$("#addModal").modal("hide");$("#AccepptVersionCreation").prop("checked",!1)});$("#btndepent").click(function(){$("#dependentMilestones").modal("hide")});$("#SaveVerionRemarks").click(function(){VersionReamrks=$("#VersionRemarks").val();var n=$("#Version").val();if(n=="")return $("#VersionError").text("Please Enter the Version"),!1;if(VersionReamrks=="")return $("#VersionRemarksError").text("Please Enter the Remarks"),!1;$("#VersionRemarkspop").modal("hide")});$("#CancelVerionRemarks").click(function(){$("#VersionRemarkspop").modal("hide");$("#AccepptVersionCreation").prop("checked",!1);$("#Versionchange").hide()});$("#global-search").on("input",function(){var f=$.trim($(this).val().toLowerCase()),e=$(".hide_section"),u=0,n=0,t=0,i=0,r=0;e.each(function(){var o=$(this).find(".open_list"),s=o.text().toLowerCase(),e;s.includes(f)?($(this).css("display","block"),e=$(this).find(".text-info").html(),e=="Open"?n++:e=="In Progress"?t++:e=="OverDue"?r++:e=="Completed"&&i++):$(this).css("display","none");u=n+t+i+r;$("#cardscount").text(u);$(".count_open").text(n);$(".count_inprogress").text(t);$(".count_completed").text(i);$(".count_overdue").text(r)})});