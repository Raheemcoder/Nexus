function CreateJQGrid(n){var t;$.jgrid.gridUnload("#jqgrid");jQuery("#jqgrid").jqGrid({url:ROOT+"MasterManagement/MMProjectList?"+n,datatype:"JSON",mtype:"GET",colModel:colModels,width:1,rowNum:1e4,viewrecords:!0,scroll:!0,pager:"#pager",loadonce:!0,gridComplete:function(){var n,r,t;if(n=$("#jqgrid tbody tr"),r=$("#jqgrid tbody tr td"),n.length>1)for(t=$(n[1]).children("td"),i=0;i<t.length;i++)$(t[i]).css("width",$(r[i]).css("width"))}});$("#jqgrid").jqGrid("filterToolbar",{autosearch:!0,stringResult:!0,searchOnEnter:!1,defaultSearch:"cn"});$(".ui-jqgrid-bdiv").css({"max-height":"300px"});$(".ui-jqgrid-bdiv").children("div").css({height:"auto"});t=$(".ui-jqgrid-bdiv").find("tbody").height();t>230?($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hdiv").css("padding-right","17px")):($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hdiv").css("padding-right","0px"))}var isExport=0,colModels=[{name:"Action",label:"Action",width:110,resizable:!0,ignoreCase:!0,exportcol:!1,classes:"text-center",search:!1,formatter:function(n,t,i){return'<div class="grid-icons-group -justify-center"><a id="prject-edit" href='+ROOT+"MasterManagement/EditMMProjectMaster?q="+Encrypt("ProjectCode="+i.ProjectCode+"&IsMilestonesCompleted="+i.AllMilestonesCompleted+"&Status="+i.Status)+' class="grid-icon-only prject-edit" title="Edit" ><i class="fas fa-pen"><\/i><\/a><\/div>'}},{name:"ProjectCode",label:"Project Code",width:100,search:!0,resizable:!0,ignoreCase:!0},{name:"ProjectName",resizable:!0,label:"Project Name",width:100,ignoreCase:!0},{name:"Hub",resizable:!0,label:"Project Hub",width:100,ignoreCase:!0},{name:"Division",resizable:!0,label:"Project Division",width:100,ignoreCase:!0},{name:"Type",label:"Project Type",resizable:!0,width:100,ignoreCase:!0},{name:"Manager",resizable:!0,label:"Project Manager/Responsible",width:100,ignoreCase:!0},{name:"Status",resizable:!0,width:70,label:"Project Status",ignoreCase:!0,title:!1,stype:"select",searchoptions:{value:":All;In Progress:In Progress;Planning:Planning;Completed:Completed;Locked:Locked"},formatter:function(n,t,i){if(isExport==0){var r=$("<div>").html(i.Status).text();return'<span class="'+i.Class+' status_text ">'+r+"<\/span>"}return n}}];$(document).ready(function(){CreateJQGrid("Divisions=&Status=&IsFiltered=NO")});$(document).on("click","#ProjectMasterExport",function(){isExport=1;var n=$("#jqgrid").jqGrid("getGridParam","data");$("#jqgrid").jqGrid("exportToExcel",{includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"ProjectMaster.xlsx",maxlength:40});isExport=0});$("#projectsFilter").click(function(){var n=$("#Divisions").val().toString(),t=$("#Status").val().toString();$(".multiselect-search").val("");CreateJQGrid("Divisions="+n+"&Status="+t+"&IsFiltered=Yes")});