function ProjectUpdateLoad(){var n=$("#PUDivision").val(),t=$("#PURandDName").val(),r=$("#PUStatus").val(),u=$("#PUProjectType").val(),f=$("#PUProjectClassification").val(),e=$("#PUYesNo").val(),o=$("#Projectleaddetails").val(),s=$("#userName").val();$.ajax({type:"POST",url:ROOT+"ProjectUpdates/ProjectUpdatesHeaderData",data:{PUDivision:n,PURandD:t,Status:r,ProjectType:u,ProjectClassification:f,Updates:e,ProjectLead:o,UserName:s},success:function(n){App_jsons=JSON.parse(n);$.jgrid.gridUnload("#ProjectUpdatesList");$("#ProjectUpdatesList").jqGrid({height:"auto",datatype:"local",data:App_jsons,mtype:"GET",colModel:colmodels,loadonce:!0,viewrecords:!0,pager:"#pager_ProjectUpdatesList",rowNum:3e3,scroll:!0,gridComplete:function(){var t=$("#ProjectUpdatesList tbody tr"),r=$("#ProjectUpdatesList tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))}});$("#ProjectUpdatesList").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"});$(".ui-jqgrid-bdiv").css({"max-height":"45vh"});$(".ui-jqgrid-bdiv").children("div").css({"min-height":"10vh"});var t=$(".ui-jqgrid-bdiv").find("tbody").height();t>258?($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".m-table__responsive").find(".ui-jqgrid-htable").css("padding-right","17px")):$(".m-table__responsive").find(".ui-jqgrid-htable").css("padding-right","0px")},error:function(){alert("Error occured!!")}})}function onClickEditProjectUpdates(n){var t=GetRowDataInArray(n);window.location.href=ROOT+"ProjectUpdates/EditProjectUpdates?q="+Encrypt("projectCode="+t.ProjectCode)}function onClickHistoryProjectUpdates(n){var t=GetRowDataInArray(n);window.location.href=ROOT+"ProjectUpdates/Project_Updates_History?q="+Encrypt("ProjectCode="+t.ProjectCode)}function GetRowDataInArray(n){var t=$("#ProjectUpdatesList"),i=$(n).closest("tr.jqgrow").attr("id"),r=t.jqGrid("getCell",i,"ProjectCode"),u=t.jqGrid("getCell",i,"ProjectId"),f=t.jqGrid("getCell",i,"ProjectName"),e=t.jqGrid("getCell",i,"HubId");return{ProjectCode:r,ProjectId:u,ProjectName:f,HubId:e}}function showCommentsPopup(n,t){var i=$("#commentsRow"+n).attr("data-comments");$("#commentsData").html(i);$("#commentModalPopup").text(t);$("#commentsModal").modal("show")}function formatComments(n,t,i){var u,f,e;if(n!="No Updates Available"){u=$("<div><\/div>");u.html(n);var r=u.find("li"),o=r.length,s="";return o>4&&(r=r.slice(0,4),s=$("<div><\/div>"),s.html(r)),f="",o>4?(f+=`<a href="#" class="read-more-show" data-comments="${n}" id="commentsRow${t.rowId}" onclick="showCommentsPopup(${t.rowId},'`+i+`')">Read More</a>`,e="",r.each(function(){e+=this.outerHTML}),"<ol>"+e+"<\/ol>"+f):"<div>"+n+"<\/div>"}return n}function onclickGanchatt(n){var t=GetRowDataInArray(n);window.location.href=ROOT+"GanttChart/Index?q="+Encrypt("projectId="+t.ProjectId+"&projectCode="+t.ProjectCode+"&isFromPu=Yes&projectName="+encodeURIComponent(t.ProjectName)+"&Hub="+t.HubId)}var projectUpdatesDetailsHeaderData=$.parseJSON($("#ProjectUpdatesDetailsHeaderData").val()),roleId=$("#RoleId").val(),isExport=!1,$TableHeight;$(".prototype_").hide();$(".prototype_1").hide();$(".prototype_3").hide();colmodels=[{name:"Action",label:"Action",resizable:!0,ignoreCase:!0,filter:!1,width:100,search:!1,formatter:function(){return roleId=="5"?`<div class="justify-center_ d-flex">
                         <a href="#" onclick="onclickGanchatt(this)" class="btn-icon -add" title="Gantt Chart" ><i class="fas fa-chart-bar" aria-hidden="true"></i></a>
                         <a href="#" onclick="onClickHistoryProjectUpdates(this)" class="btn-icon -history" title="View History" ><i style="backgroundcolor" class="fas fa-history" aria-hidden="true"></i></a>
                     </div>`:`<div class="justify-center_ d-flex">
                         <a href="#" onclick="onclickGanchatt(this)" class="btn-icon -add" title="Gantt Chart" ><i class="fas fa-chart-bar" aria-hidden="true"></i></a>
                         <a onclick="onClickEditProjectUpdates(this)" class="btn-icon -edit" title="Edit"><i class="fas fa-edit"></i></a>
                         <a href="#" onclick="onClickHistoryProjectUpdates(this)" class="btn-icon -history" title="View History" ><i style="backgroundcolor" class="fas fa-history" aria-hidden="true"></i></a>
                    </div>`}},{name:"ProjectCode",label:"Project Id",resizable:!0,ignoreCase:!0,width:110},{name:"ProjectId",label:"Project Id",resizable:!0,ignoreCase:!0,width:110,hidden:!0},{name:"ProjectName",label:"Project Description",resizable:!0,ignoreCase:!0,width:170},{name:"StartDate",label:"Start Date",resizable:!0,ignoreCase:!0,width:110},{name:"EndDate",label:"End Date",resizable:!0,ignoreCase:!0,width:110},{name:"LastMonth",label:"Last Month Updates",resizable:!0,ignoreCase:!0,width:270,exportcol:!0,formatter:function(n,t){var i;return isExport?(i=$("<div>").html(n),i.find("ol").each(function(){$(this).find("li").text(function(n,t){return n+1+". "+t})}),i.text()):formatComments(n,t,"Last Month Updates")}},{name:"CurrentMonth",label:"Current Month Updates",resizable:!0,ignoreCase:!0,width:270,exportcol:!0,formatter:function(n,t){var i;return isExport?(i=$("<div>").html(n),i.find("ol").each(function(){$(this).find("li").text(function(n,t){return n+1+". "+t})}),i.text()):formatComments(n,t,"Current Month Updates")}},{name:"ProjectHub",label:"HUBs",resizable:!0,ignoreCase:!0,width:110},{name:"ProjectDivision",label:"Division",resizable:!0,ignoreCase:!0,width:130},{name:"Sku",label:"SKU",resizable:!0,ignoreCase:!0,width:130},{name:"TargetTTD",label:"Target TTD",resizable:!0,ignoreCase:!0,width:130},{name:"TargetProductionDate",label:"Target Production Date",resizable:!0,ignoreCase:!0,width:130},{name:"ProjectType",label:"Project Type",resizable:!0,ignoreCase:!0,width:110,hidden:!0},{name:"ProjectClassification",label:"Project Classification",resizable:!0,ignoreCase:!0,width:160,hidden:!0},{name:"RAndDName",label:"R&D Name",resizable:!0,ignoreCase:!0,width:100},{name:"ProjectLead",label:"Project Lead",resizable:!0,ignoreCase:!0,width:110},{name:"HubId",label:"HubId",resizable:!0,ignoreCase:!0,width:110,hidden:!0},{name:"ProjectStatus",label:"Project Status",resizable:!0,ignoreCase:!0,width:120,formatter:function(n){if(roleId==5){if(n=="Completed")return'<a onclick="onClickHistoryProjectUpdates(this)" <p class="text-success">'+n+"<\/p><\/a>";if(n=="Planning")return'<a onclick="onClickHistoryProjectUpdates(this)" <p class="text-warning">'+n+"<\/p><\/a>";if(n=="In Progress")return'<a onclick="onClickHistoryProjectUpdates(this)" <p class="text-info">'+n+"<\/p><\/a>";if(n=="Locked")return'<a onclick="onClickHistoryProjectUpdates(this)" <p class="text-danger">'+n+"<\/p><\/a>"}else{if(n=="Completed")return'<a onclick="onClickEditProjectUpdates(this)" <p class="text-success">'+n+"<\/p><\/a>";if(n=="Planning")return'<a onclick="onClickEditProjectUpdates(this)" <p class="text-warning">'+n+"<\/p><\/a>";if(n=="In Progress")return'<a onclick="onClickEditProjectUpdates(this)" <p class="text-info">'+n+"<\/p><\/a>";if(n=="Locked")return'<a onclick="onClickEditProjectUpdates(this)" <p class="text-danger">'+n+"<\/p><\/a>"}}},{name:"StatusName",label:"Project Status",resizable:!0,ignoreCase:!0,exportcol:!0,hidden:!0},];$("#ProjectUpdatesList").jqGrid({url:"",datatype:"local",data:projectUpdatesDetailsHeaderData.length==0?[]:projectUpdatesDetailsHeaderData,mtype:"GET",colModel:colmodels,loadonce:!0,viewrecords:!0,pager:"#pager_ProjectUpdatesList",rowNum:projectUpdatesDetailsHeaderData.length,scroll:1,gridComplete:function(){var t=$("#ProjectUpdatesList tbody tr"),r=$("#ProjectUpdatesList tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))}});$("#ProjectUpdatesList").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"});$(".ui-jqgrid-bdiv").css({"max-height":"45vh"});$(".ui-jqgrid-bdiv").children("div").css({"min-height":"auto"});$TableHeight=$(".ui-jqgrid-bdiv").find("tbody").height();$TableHeight>258?($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".m-table__responsive").find(".ui-jqgrid-htable").css("padding-right","17px")):$(".m-table__responsive").find(".ui-jqgrid-htable").css("padding-right","0px");$("[data-datepicker-year]").datepicker({format:"yyyy",viewMode:"years",minViewMode:"years",autoclose:!0});$(document).ready(function(){$("#Projectleaddetails").select2();$(".filterable .btn-filter").click(function(){var t=$(this).parents(".filterable"),n=t.find(".filters input"),i=t.find(".table tbody");n.prop("disabled")==!0?(n.prop("disabled",!1),n.first().focus()):(n.val("").prop("disabled",!0),i.find(".no-result").remove(),i.find("tr").show())});$(".filterable .filters input").keyup(function(n){var e=n.keyCode||n.which;if(e!="9"){var i=$(this),o=i.val().toLowerCase(),u=i.parents(".filterable"),s=u.find(".filters th").index(i.parents("th")),t=u.find(".table"),r=t.find("tbody tr"),f=r.filter(function(){var n=$(this).find("td").eq(s).text().toLowerCase();return n.indexOf(o)===-1});t.find("tbody .no-result").remove();r.show();f.hide();f.length===r.length&&t.find("tbody").prepend($('<tr class="no-result text-center"><td colspan="'+t.find(".filters th").length+'">No result found<\/td><\/tr>'))}})});setTimeout(function(){$("#message_alert").fadeOut("slow")},5e3);$("#SearchPUData").on("click",function(){ProjectUpdateLoad()});$("#ExcelDownload").click(function(){var n,t;if(isExport=!0,n=$("#ProjectUpdatesList"),n.hideCol("Action"),n.hideCol("ProjectStatus"),t=$("#ProjectUpdatesList").jqGrid("getGridParam","data"),t.length==0)alert("No data in Grid");else{try{$("#ProjectUpdatesList").jqGrid("exportToExcel",{includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"ProjectUpdates.xlsx",maxlength:80,exportcol:!0})}catch(i){alert(i)}n.showCol("Action");n.showCol("ProjectStatus")}isExport=!1});roleId==5&&$("#editIcon").hide();