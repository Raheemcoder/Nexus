function getRowDataInArray(n){var k=$(n).closest("tr"),d=$("#ProductLaunchInfo_Grid"),g=$(n).closest("tr.jqgrow").attr("id"),t=$.trim($(n).closest("tr").find("td.MaterialCode").text()),i=$.trim($(n).closest("tr").find("td.MaterialName").text()),r=$.trim($(n).closest("tr").find("td.CreatedDate").text()),u=$.trim($(n).closest("tr").find("td.Source").text()),f=$.trim($(n).closest("tr").find("td.IsNPDValue1 select.IsNPD").val()),e=$.trim($(n).closest("tr").find("td.BusinessLaunchDate input.BusinessLaunchDate").val())!=""?$.trim($(n).closest("tr").find("td.BusinessLaunchDate input.BusinessLaunchDate").val()):$.trim($(n).closest("tr").find("td.BusinessLaunchDate").text()),o=$.trim($(n).closest("tr").find("td.RandDLaunchDate input.RandDLaunchDate").val())!=""?$.trim($(n).closest("tr").find("td.RandDLaunchDate input.RandDLaunchDate").val()):$.trim($(n).closest("tr").find("td.RandDLaunchDate").text()),s=$.trim($(n).closest("tr").find("td.StatusId").text()),h=$.trim($(n).closest("tr").find("td.Remarks").text()),c=$.trim($(n).closest("tr").find("td.UpdatedBy").text()),l=$.trim($(n).closest("tr").find("td.ApprovedOrRejectedBy").text()),a=$.trim($(n).closest("tr").find("td.HGMLCategory").text()),v=$.trim($(n).closest("tr").find("td.HGMLSubCategory").text()),y=$.trim($(n).closest("tr").find("td.ProductGroup").text()),p=$.trim($(n).closest("tr").find("td.HGMLDivision").text()),w=$.trim($(n).closest("tr").find("td.HGMLFormulation").text()),b=$.trim($(n).closest("tr").find("td.IsProductHierarchyFilled").text());return{MaterialCode:t,MaterialName:i,CreatedDate:r,Source:u,IsNPD:f,BusinessLaunchDate:e,RandDLaunchDate:o,StatusId:s,Remarks:h,UpdatedBy:c,ApprovedOrRejectedBy:l,HGMLCategory:a,HGMLSubCategory:v,ProductGroup:y,HGMLDivision:p,HGMLFormulation:w,IsProductHierarchyFilled:b}}function onClickSaveInGridRowDuringReject(n){var t=[],i=getRowDataInArray(n),r;t.push(i);var f=i.MaterialCode,u=[];if(t.length!=0){t.forEach(function(n){n.IsNPD!==""&&u.push(n.MaterialCode)});r=u.join(", ");const n=` ${r!=""?`The following products <b>${r}</b> Launch Information will be submitted for HGML approval. Do you want to continue?`:`Are you sure you want to save the details?`}`;confirm(n,function(){$("#ProductLaunchInformationData").val(JSON.stringify(i));$("#ProductLaunchInformation_Submit").submit()})}}function onClickCloseInGridRowDuringReject(n){var f=$(n).closest("tr"),o=$("#ProductLaunchInfo_Grid"),s=$(n).closest("tr.jqgrow").attr("id"),e=o.jqGrid("getCell",s,"MaterialCode"),r,i,u,t;for(editedProductLaunchInfoData=editedProductLaunchInfoData.filter(n=>n.MaterialCode!==e),r=$.trim($(n).closest("tr").find("td.IsNPDValue1 select.IsNPD").val()),r=="0"?r="No":r=="1"&&(r="Yes"),i=launchInfoInitialData.filter(n=>n.MaterialCode===e),u="",u=`<select class="form-control appearence IsNPD save_edit" id='`+i[0].MaterialCode+`IsNPD'>
                    <option value="">Select</option>`,t=0;t<isNpdList.length;t++)u+=i[0].IsNPD==isNpdList[t].Text?'<option selected  value="'+isNpdList[t].Value+'">'+isNpdList[t].Text+"<\/option>":'<option  value="'+isNpdList[t].Value+'">'+isNpdList[t].Text+"<\/option>";u+=`</select><span class="value_close">`+i[0].IsNPD+`</span>`;$(f).find(".IsNpdOption").empty();$(f).find(".IsNpdOption").append(u);$(f).find(".RandDLaunchDate").val(i[0].RandDLaunchDate);$(f).find(".BusinessLaunchDate").val(i[0].BusinessLaunchDate)}var editedProductLaunchInfoData;var gridData=[],launchInfoInitialData=[],isNpdList=$.parseJSON($("#IsNpdList_Serialized").val()),sourceList=$.parseJSON($("#SourceString").val()),sourceOption="",isNpdOption="";$(document).ready(function(){for(var n=0;n<sourceList.length;n++)sourceOption+=`<option value="`+sourceList[n].SourceName+`" >`+sourceList[n].SourceName+`</option>`;for(n=0;n<isNpdList.length;n++)isNpdOption+='<option  value="'+isNpdList[n].Value+'">'+isNpdList[n].Text+"<\/option>";colmodels=[{name:"Action",label:"Action",width:70,resizable:!0,ignoreCase:!0,exportcol:!1,search:!1,formatter:function(n,t,i){return i.StatusId==3?`<div class="text-center">
                            <div>
                                <span class="btn-icon -edit close_edit" ><i class="fas fa-edit" title="Edit"></i></span>
                            </div>
                            <div class="save_edit1">
                                <span class="btn-icon -view" onclick="onClickSaveInGridRowDuringReject(this)"><i class="fas fa-save" title="Save"></i></span>
                                <span class="btn-icon -delete time_cross" onclick="onClickCloseInGridRowDuringReject(this)"><i class="fas fa-times" title="Close"></i></span>
                            </div>
                        </div>`:""}},{name:"MaterialCode",label:"Material Code",resizable:!0,ignoreCase:!0,width:100,classes:"MaterialCode"},{name:"MaterialName",label:"Material Name",resizable:!0,ignoreCase:!0,width:200,classes:"MaterialName"},{name:"CreatedDate",label:"Material Created Date",resizable:!0,ignoreCase:!0,width:100,classes:"CreatedDate",sorttype:"date",formatter:"date",formatoptions:{newformat:"d-m-Y"},exportcol:!1},{name:"MaterialCreatedDate",label:"Material Created Date",resizable:!0,ignoreCase:!0,width:100,hidden:!0,exportcol:!0},{name:"HGMLCategory",label:"HGML Category",resizable:!0,ignoreCase:!0,width:140,exportcol:!0,classes:"HGMLCategory"},{name:"HGMLDivision",label:"HGML Division",resizable:!0,ignoreCase:!0,width:120,exportcol:!0,classes:"HGMLDivision"},{name:"BusinessLaunchDate",label:"Business Launch Date",resizable:!0,ignoreCase:!0,width:130,exportcol:!1,classes:"BusinessLaunchDate",formatter:function(n,t,i){var u=editedProductLaunchInfoData.findIndex(n=>n.MaterialCode==i.MaterialCode),r;return r=u>=0?editedProductLaunchInfoData[u].BusinessLaunchDate:i.BusinessLaunchDate,i.StatusId!=3?r==""||r==null||r==undefined?`<div class="text-left datepicker-container">
                        <input type="text" onpaste="return false;" class="form-control input_height data-datepicker BusinessLaunchDate datepicker-input" id='`+i.MaterialCode+`BusinessLaunchDate'/>
                        <span class="datepicker-symbol"></span>
                        </div>`:r!=i.BusinessLaunchDate?`<div class="text-left datepicker-container">
                        <input type="text" onpaste="return false;" value="`+r+`" class="form-control input_height data-datepicker BusinessLaunchDate datepicker-input" id='`+i.MaterialCode+`BusinessLaunchDate'/>
                        <span class="datepicker-symbol"></span>
                        </div>`:r:r==""||r==null||r==undefined?`<div class="text-left datepicker-container">
                        <input type="text" onpaste="return false;" class="form-control input_height data-datepicker BusinessLaunchDate datepicker-input" id='`+i.MaterialCode+`BusinessLaunchDate'/>
                        <span class="datepicker-symbol"></span>
                        </div>`:`<div class="text-left datepicker-container">
                                <input type="text" onpaste="return false;" class="form-control input_height save_edit data-datepicker BusinessLaunchDate datepicker-input" id='`+i.MaterialCode+`BusinessLaunchDate' value=" `+r+`" />
                                <span class="datepicker-symbol save_edit"></span>
                                <span class="value_close"> `+i.BusinessLaunchDate+`</span>
                            </div>`}},{name:"RandDLaunchDate",label:"R&D Launch Date",resizable:!0,ignoreCase:!0,exportcol:!1,width:130,classes:"RandDLaunchDate",formatter:function(n,t,i){var u=editedProductLaunchInfoData.findIndex(n=>n.MaterialCode==i.MaterialCode),r;return r=u>=0?editedProductLaunchInfoData[u].RandDLaunchDate:i.RandDLaunchDate,i.StatusId!=3?r==""||r==null||r==undefined?`<div class="text-left datepicker-container">
                    <input type="text" onpaste="return false;" class="form-control input_height data-datepicker RandDLaunchDate datepicker-input" id='`+i.MaterialCode+`RandDLaunchDate'/>
                    <span class="datepicker-symbol"></span>
                    </div>`:r!=i.RandDLaunchDate?`<div class="text-left datepicker-container">
                    <input type="text" value="`+r+`" onpaste="return false;" class="form-control input_height data-datepicker RandDLaunchDate datepicker-input" id='`+i.MaterialCode+`RandDLaunchDate'/>
                    <span class="datepicker-symbol"></span>
                    </div>`:r:r==""||r==null||r==undefined?`<div class="text-left datepicker-container">
                    <input type="text" onpaste="return false;" class="form-control input_height data-datepicker RandDLaunchDate datepicker-input" id='`+i.MaterialCode+`RandDLaunchDate'/>
                    <span class="datepicker-symbol"></span>
                    </div>`:`<div class="text-left datepicker-container">
                            <input type="text" onpaste="return false;" class="form-control input_height save_edit data-datepicker RandDLaunchDate datepicker-input" id='`+i.MaterialCode+`RandDLaunchDate' value=" `+r+`" />
                            <span class="datepicker-symbol save_edit"></span>
                            <span class="value_close"> `+i.RandDLaunchDate+`</span>
                        </div>`}},{name:"Source",label:"Source",resizable:!0,ignoreCase:!0,width:120,exportcol:!1,classes:"Source"},{name:"IsNPD",label:"Is NPD",resizable:!0,ignoreCase:!0,width:120,exportcol:!1,classes:"IsNPDValue1",cellattr:function(){return'title=""'},formatter:function(n,t,i){var e=editedProductLaunchInfoData.findIndex(n=>n.MaterialCode==i.MaterialCode),u,f,r;if(u=e>=0?editedProductLaunchInfoData[e].IsNPD=="1"?"Yes":editedProductLaunchInfoData[e].IsNPD=="0"?"No":editedProductLaunchInfoData[e].IsNPD:i.IsNPD,i.StatusId!=3){if(u==""||u==null||u==undefined)return f="",`<div class="text-left IsNpdOption">
                               <select class="form-control appearence IsNPD" id='`+i.MaterialCode+`IsNPD'>
                                    <option value="">Select</option>`+isNpdOption+`</select>
                        </div>`;for(f="",r=0;r<isNpdList.length;r++)f+=u==isNpdList[r].Text?'<option selected  value="'+isNpdList[r].Value+'">'+isNpdList[r].Text+"<\/option>":'<option  value="'+isNpdList[r].Value+'">'+isNpdList[r].Text+"<\/option>";return`<div class="text-left IsNpdOption">
                               <select class="form-control appearence IsNPD ${u===i.IsNPD?"save_edit":""}" id='`+i.MaterialCode+`IsNPD'>
                                    <option value="">Select</option>`+f+`</select>
                            ${u===i.IsNPD?'<span class="value_close">'+u+"<\/span>":""}
                        </div>`}if(u==""||u==null||u==undefined)return`<div class="text-left IsNpdOption">
                               <select class="form-control appearence IsNPD" id='`+i.MaterialCode+`IsNPD'>
                                    <option value="">Select</option>`+isNpdOption+`</select>
                        </div>`;for(f="",r=0;r<isNpdList.length;r++)f+=u==isNpdList[r].Text?'<option selected  value="'+isNpdList[r].Value+'">'+isNpdList[r].Text+"<\/option>":'<option  value="'+isNpdList[r].Value+'">'+isNpdList[r].Text+"<\/option>";return`<div class="text-left IsNpdOption">
                               <select class="form-control save_edit appearence IsNPD" id='`+i.MaterialCode+`IsNPD'>
                                    <option value="">Select</option>`+f+`</select>
                               <span class="value_close">`+i.IsNPD+`</span>
                        </div>`}},{name:"StatusName",label:"Status",resizable:!0,ignoreCase:!0,exportcol:!1,classes:"StatusName",formatter:function(n,t,i){return i.StatusId==1?'<a <p class="text-warning">'+i.StatusName+"<\/p><\/a>":i.StatusId==2?'<a <p class="text-success">'+i.StatusName+"<\/p><\/a>":i.StatusId==3?'<a <p class="text-danger">'+i.StatusName+"<\/p><\/a>":'<a <p class=""><\/p><\/a>'}},{name:"StatusId",label:"Status",resizable:!0,ignoreCase:!0,hidden:!0,classes:"StatusId"},{name:"BusinessLaunchDate",label:"Business Launch Date",resizable:!0,ignoreCase:!0,width:120,hidden:!0,exportcol:!0,classes:"BusinessLaunchDate"},{name:"RandDLaunchDate",label:"R&D Launch Date",resizable:!0,ignoreCase:!0,width:120,hidden:!0,exportcol:!0,classes:"RandDLaunchDate"},{name:"Source",label:"Source",resizable:!0,ignoreCase:!0,width:120,hidden:!0,exportcol:!0},{name:"IsNPD",label:"IsNPD",resizable:!0,ignoreCase:!0,width:120,hidden:!0,exportcol:!0,classes:"IsNPDValue2"},{name:"StatusName",label:"Status",resizable:!0,ignoreCase:!0,hidden:!0,exportcol:!0,classes:"StatusName"},{name:"Remarks",label:"Remarks",resizable:!0,ignoreCase:!0,classes:"Remarks"},{name:"UpdatedBy",label:"Updated by",resizable:!0,ignoreCase:!0,classes:"UpdatedBy"},{name:"ApprovedOrRejectedBy",label:"Approved /Rejected by",resizable:!0,ignoreCase:!0,classes:"ApprovedOrRejectedBy"},{name:"HGMLSubCategory",label:"HGML SubCategory",resizable:!0,ignoreCase:!0,width:100,hidden:!0,classes:"HGMLSubCategory"},{name:"ProductGroup",label:"Product Group",resizable:!0,ignoreCase:!0,width:100,hidden:!0,classes:"ProductGroup"},{name:"HGMLFormulation",label:"HGML Formulation",resizable:!0,ignoreCase:!0,width:100,hidden:!0,classes:"HGMLFormulation"},{name:"IsProductHierarchyFilled",label:"Is Product Hierarchy Data Filled",resizable:!0,ignoreCase:!0,width:100,hidden:!0,classes:"IsProductHierarchyFilled"},];$("#ProductLaunchInfo_Grid").jqGrid({url:"",mtype:"GET",datatype:"local",data:[],colModel:colmodels,loadonce:!0,viewrecords:!0,rowNum:20,scroll:!0,pager:"pager_ProductLaunchInfo_Grid",rownumbers:!1,rowattr:function(n){if(n.IsProductHierarchyFilled=="0")return{style:"outline: 1.5px solid #FF0000;"}},gridComplete:function(){var i=$("#ProductLaunchInfo_Grid tbody tr"),u=$("#ProductLaunchInfo_Grid tbody tr td"),t,r;if(i.length>1)for(t=$(i[1]).children("td"),n=0;n<t.length;n++)$(t[n]).css("width",$(u[n]).css("width"));$(".data-datepicker").datepicker({format:"dd-mm-yyyy",todayHighlight:!0,autoclose:!0});$(".ui-jqgrid-bdiv").css({"max-height":"45vh"});$(".ui-jqgrid-bdiv").children("div").css({"min-height":"10vh"});r=$(".ui-jqgrid-bdiv").find("tbody").height();r>330?($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".m-table__responsive").find(".ui-jqgrid-htable").css("padding-right","17px")):$(".m-table__responsive").find(".ui-jqgrid-htable").css("padding-right","0px")}});$("#ProductLaunchInfo_Grid").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"});$.ajax({type:"POST",datatype:"json",url:ROOT+"NPDLaunchMaster/OnSearchProductLaunchInformation",data:{npdLaunchYearType:"All",npdLaunchYear:""},success:function(n){launchInfoInitialData=n;$("#ProductLaunchInfo_Grid").jqGrid("clearGridData");$("#ProductLaunchInfo_Grid").jqGrid("setGridParam",{data:launchInfoInitialData});$("#ProductLaunchInfo_Grid").trigger("reloadGrid",[{page:1}]);$(".data-datepicker").datepicker({format:"dd-mm-yyyy",todayHighlight:!0,autoclose:!0})},error:function(){alert("Error occured!!")}})});$(".data-datepicker").datepicker({format:"dd-mm-yyyy",todayHighlight:!0,autoclose:!0});$(".date-datepicker-year").datepicker({format:"yyyy",viewMode:"years",minViewMode:"years",autoclose:!0});$(".year_dropdown").css("display","none");$("input[name='chkPinNo']").click(function(){$("#chkNo").is(":checked")?$(".year_dropdown").css("display","block"):$("#chkYes").is(":checked")?$(".year_dropdown").css("display","block"):$("#chkAll").is(":checked")&&$(".year_dropdown").css("display","none")});setTimeout(function(){$("#message_alert").fadeOut("slow")},5e3);$(document).on("click",".close_edit",function(){var n=$(this).closest("tr");n.addClass("show_edit");n.find("select.save_edit").show();n.find(".value_close").hide()});$(document).on("click",".time_cross",function(){var n=$(this).closest("tr");n.removeClass("show_edit");n.find(".close_edit, .value_close").show();n.find("select.save_edit").hide();n.find(".save_edit1").hide();n.find(".save_edit").hide()});$(".multiselect").multiselect({includeSelectAllOption:!0,buttonWidth:220,maxHeight:300,enableCaseInsensitiveFiltering:!0,enableFiltering:!0});$(document).ready(function(){$(".NpdLaunchYear").hide();$("#NpdLaunchYearType").on("change",function(){$("#NpdLaunchYear").val("");this.value=="Business Launch Year"?$(".NpdLaunchYear").show():this.value=="R&D Launch Year"?$(".NpdLaunchYear").show():$(".NpdLaunchYear").hide()})});$("#ExcelDownload").click(function(){var i=$("#ProductLaunchInfo_Grid"),n=$("#ProductLaunchInfo_Grid").jqGrid("getGridParam","data");if(n.length==0)alert("No data in Grid");else try{$("#ProductLaunchInfo_Grid").jqGrid("exportToExcel",{includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"ProductLaunchInfo.xlsx",maxlength:80,exportcol:!0})}catch(t){alert(t)}});$("#onClickSearch").click(function(){var t=$("#NpdHmlDivision").val(),i=$("#NpdHgmlCategory").val().toString(),r=$("#NpdLaunchYearType").val(),n=$("#NpdLaunchYear").val(),u=$("#Status").val();NpdLaunchYearType=="All"&&(n="");$.ajax({type:"POST",url:ROOT+"NPDLaunchMaster/OnSearchProductLaunchInformation",data:{division:t,category:i,npdLaunchYearType:r,npdLaunchYear:n,status:u},success:function(n){launchInfoInitialData=n;$("#ProductLaunchInfo_Grid").jqGrid("clearGridData");$("#ProductLaunchInfo_Grid").jqGrid("setGridParam",{data:launchInfoInitialData});$("#ProductLaunchInfo_Grid").trigger("reloadGrid",[{page:1}]);$(".data-datepicker").datepicker({format:"dd-mm-yyyy",todayHighlight:!0,autoclose:!0})},error:function(){alert("Error occured!!")}})});editedProductLaunchInfoData=[];$("body").on("change",".IsNPD, .BusinessLaunchDate, .RandDLaunchDate, .Source",function(){rowData=getRowDataInArray(this);var n=editedProductLaunchInfoData.findIndex(n=>n.MaterialCode===rowData.MaterialCode);n!==-1?editedProductLaunchInfoData[n]=rowData:editedProductLaunchInfoData.push(rowData)});$(".SaveProductLaunchInfo").on("click",function(){var n,i,t;if(n=[],i=[],editedProductLaunchInfoData.length!=0){editedProductLaunchInfoData.forEach(function(t){t.IsNPD!==""&&n.push(t.MaterialCode)});t=n.join(", ");const i=` ${t!=""?`The following products <b>${t}</b> Launch Information will be submitted for HGML approval. Do you want to continue?`:`Are you sure you want to save the details?`}`;confirm(i,function(){$("#ProductLaunchInformationData").val(JSON.stringify(editedProductLaunchInfoData));$("#ProductLaunchInformation_Submit").submit()})}else alert("There are no changes to save.")});$(document).on("keydown paste",".BusinessLaunchDate",function(n){n.preventDefault()});$(document).on("keydown paste",".RandDLaunchDate",function(n){n.preventDefault()});$("[data-singleselect]").select2();$(".data-singleselect").select2();