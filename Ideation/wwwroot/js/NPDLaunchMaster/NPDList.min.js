function NPDListLoad(){var n=$("#NpdHmlDivision").val(),t=$("#NpdHgmlCategory").val(),i=$("#NpdHgmlProductGroup").val(),r=$("#NpdHgmlFormulation").val(),u=$("#NpdHgmlSource").val();$.ajax({type:"POST",url:ROOT+"NPDLaunchMaster/NPDLaunchMasterHeaderData",data:{division:n,category:t,productGroup:i,formulation:r,source:u},success:function(n){var t=JSON.parse(n);$("#NPDlist_Grid").jqGrid("clearGridData");$("#NPDlist_Grid").jqGrid("setGridParam",{data:t});$("#NPDlist_Grid").trigger("reloadGrid",[{page:1}])},error:function(){alert("Error occured!!")}})}function getRowDataInArray(n){var u=$(n).closest("tr"),f=$("#NPDlist_Grid"),e=$(n).closest("tr.jqgrow").attr("id"),t=$.trim($(n).closest("tr").find("td.MaterialCode").text()),i=$.trim($(n).closest("tr").find("td.BusinessLaunchDate input.BusinessLaunchDate").val())!=""?$.trim($(n).closest("tr").find("td.BusinessLaunchDate input.BusinessLaunchDate").val()):$.trim($(n).closest("tr").find("td.BusinessLaunchDate").text()),r=$.trim($(n).closest("tr").find("td.RandDLaunchDate input.RandDLaunchDate").val())!=""?$.trim($(n).closest("tr").find("td.RandDLaunchDate input.RandDLaunchDate").val()):$.trim($(n).closest("tr").find("td.RandDLaunchDate").text());return{MaterialCode:t,BusinessLaunchDate:i,RandDLaunchDate:r}}function onClickCloseInGridRowDuringReject(n){var i=$(n).closest("tr"),u=$("#NPDlist_Grid"),f=$(n).closest("tr.jqgrow").attr("id"),r=$.trim($(n).closest("tr").find("td.MaterialCode").text()),t;editedNpdListData=editedNpdListData.filter(n=>n.MaterialCode.trim()!==r.trim());t=NPDLaunchMasterDetailsHeaderData.filter(n=>n.MaterialCode.trim()===r.trim());$(i).find(".RandDLaunchDate").val(t[0].RandDLaunchDate);$(i).find(".BusinessLaunchDate").val(t[0].BusinessLaunchDate)}function onClickSaveInGridRowDuringReject(n){var t=[],i=getRowDataInArray(n),u,r,f;if(t.push(i),u=i.MaterialCode,r=[],t.length!=0){t.forEach(function(n){r.push(n.MaterialCode)});f=r.join(", ");const n=`Are you sure you want to save the details?`;confirm(n,function(){$("#NpdListData").val(JSON.stringify(i));$("#NPDList_Submit").submit()})}}var NPDLaunchMasterDetailsHeaderData=$.parseJSON($("#NPDLaunchMasterDetailsHeaderData").val()),editedNpdListData=[],$TableHeight;colmodels=[{name:"Action",label:"Action",width:70,resizable:!0,ignoreCase:!0,exportcol:!1,search:!1,formatter:function(n,t,i){return i.StatusId==2?`<div class="text-center">
                            <div>
                                <span class="btn-icon -edit close_edit" ><i class="fas fa-edit" title="Edit"></i></span>
                            </div>
                            <div class="save_edit1">
                                <span class="btn-icon -view" onclick="onClickSaveInGridRowDuringReject(this)"><i class="fas fa-save" title="Save"></i></span>
                                <span class="btn-icon -delete time_cross" onclick="onClickCloseInGridRowDuringReject(this)"><i class="fas fa-times" title="Close"></i></span>
                            </div>
                        </div>`:""}},{name:"MaterialCode",label:"Material Code",resizable:!0,ignoreCase:!0,width:100,classes:"MaterialCode"},{name:"MaterialName",label:"Material Name",resizable:!0,ignoreCase:!0,width:200},{name:"CreatedDate",label:"Material Created Date",resizable:!0,ignoreCase:!0,width:100,sorttype:"date",formatter:"date",exportcol:!1,formatoptions:{newformat:"d-m-Y"}},{name:"MaterialCreatedDate",label:"Material Created Date",resizable:!0,ignoreCase:!0,width:100,hidden:!0,exportcol:!0},{name:"ProductGroup",label:"HGML Product Group",resizable:!0,ignoreCase:!0},{name:"HGMLSubCategory",label:"HGML Sub Category",resizable:!0,ignoreCase:!0},{name:"HGMLCategory",label:"HGML Category",resizable:!0,ignoreCase:!0},{name:"HGMLDivision",label:"HGML Division",resizable:!0,ignoreCase:!0,width:120},{name:"HGMLFormulation",label:"HGML Product Format",resizable:!0,ignoreCase:!0},{name:"BusinessLaunchYear",label:"Business Launch Year",exportcol:!0,search:!0,resizable:!0,ignoreCase:!0,width:100},{name:"BusinessLaunchDate",label:"Business Launch Date",resizable:!0,ignoreCase:!0,width:140,exportcol:!1,classes:"BusinessLaunchDate",sorttype:"date",formatter:"date",formatter:function(n,t,i){var u=editedNpdListData.findIndex(n=>n.MaterialCode==i.MaterialCode),r;return r=u>=0?editedNpdListData[u].BusinessLaunchDate:i.BusinessLaunchDate,i.StatusId==2?`<div class="text-left datepicker-container">
                                <input type="text" onpaste="return false;" class="form-control input_height save_edit data-datepicker BusinessLaunchDate datepicker-input" id='`+i.MaterialCode+`BusinessLaunchDate' value=" `+r+`" />
                                <span class="datepicker-symbol save_edit"></span>
                                <span class="value_close"> `+i.BusinessLaunchDate+`</span>
                            </div>`:r}},{name:"BusinessLaunchDate",label:"Business Launch Date",hidden:!0,exportcol:!0,search:!1,resizable:!0,ignoreCase:!0,width:140},{name:"RandDLaunchDate",label:"R&D Launch Date",resizable:!0,ignoreCase:!0,exportcol:!1,width:140,classes:"RandDLaunchDate",sorttype:"date",formatter:function(n,t,i){var u=editedNpdListData.findIndex(n=>n.MaterialCode==i.MaterialCode),r;return r=u>=0?editedNpdListData[u].RandDLaunchDate:i.RandDLaunchDate,i.StatusId==2?`<div class="text-left datepicker-container">
                            <input type="text" onpaste="return false;" class="form-control input_height save_edit data-datepicker RandDLaunchDate datepicker-input" id='`+i.MaterialCode+`RandDLaunchDate' value=" `+r+`" />
                            <span class="datepicker-symbol save_edit"></span>
                            <span class="value_close"> `+i.RandDLaunchDate+`</span>
                        </div>`:r}},{name:"RandDLaunchDate",label:"R&D Launch Date",hidden:!0,exportcol:!0,search:!1,resizable:!0,ignoreCase:!0,width:140},{name:"Source",label:"Source",resizable:!0,ignoreCase:!0,width:120},{name:"IsNPD",label:"Is NPD",resizable:!0,ignoreCase:!0,width:120},{name:"Status",label:"Status",resizable:!0,ignoreCase:!0,exportcol:!1,formatter:function(n,t,i){return i.StatusId==1?'<a <p class="text-warning">'+i.Status+"<\/p><\/a>":i.StatusId==2?'<a <p class="text-success">'+i.Status+"<\/p><\/a>":i.StatusId==3?'<a <p class="text-danger">'+i.Status+"<\/p><\/a>":'<a <p class="text-danger"><\/p><\/a>'}},{name:"Status",label:"Status",resizable:!0,ignoreCase:!0,hidden:!0,exportcol:!0},{name:"SubmittedToMyApprovalPendingBy",label:"Submitted By",resizable:!0,ignoreCase:!0,exportcol:!0},{name:"UpdatedBy",label:"Updated By",resizable:!0,ignoreCase:!0},{name:"ApprovedOrRejectedBy",label:"Approved / Rejected By",resizable:!0,ignoreCase:!0},{name:"StatusId",label:"StatusId",resizable:!0,ignoreCase:!0,hidden:!0},{name:"ApprovedOrRejectedOn",label:"Approved / Rejected On",resizable:!0,ignoreCase:!0},];$("#NPDlist_Grid").jqGrid({url:"",datatype:"local",data:NPDLaunchMasterDetailsHeaderData,mtype:"GET",colModel:colmodels,loadonce:!0,viewrecords:!0,pager:"#pager_NPDlist_Grid",rowNum:20,scroll:1,gridComplete:function(){var t=$("#NPDlist_Grid tbody tr"),r=$("#NPDlist_Grid tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"));$(".data-datepicker").datepicker({format:"dd-mm-yyyy",todayHighlight:!0,autoclose:!0})}});$.ajax({type:"POST",datatype:"json",url:ROOT+"NPDLaunchMaster/NPDLaunchMasterHeaderData",data:{division:"",category:"",productGroup:"",formulation:"",source:""},success:function(n){var t=JSON.parse(n);$("#NPDlist_Grid").jqGrid("clearGridData");$("#NPDlist_Grid").jqGrid("setGridParam",{data:t});$("#NPDlist_Grid").trigger("reloadGrid",[{page:1}]);$(".data-datepicker").datepicker({format:"dd-mm-yyyy",todayHighlight:!0,autoclose:!0})},error:function(){alert("Error occured!!")}});$("#NPDlist_Grid").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"});$(".ui-jqgrid-bdiv").css({"max-height":"45vh"});$(".ui-jqgrid-bdiv").children("div").css({"min-height":"10vh"});$TableHeight=$(".ui-jqgrid-bdiv").find("tbody").height();$TableHeight>330?($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","17px")):($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","0px"));$(".data-datepicker").datepicker({format:"dd-mm-yyyy",todayHighlight:!0,autoclose:!0});$(".date-datepicker-year").datepicker({format:"yyyy",viewMode:"years",minViewMode:"years",autoclose:!0});setTimeout(function(){$("#message_alert").fadeOut("slow")},5e3);$(".multiselect").multiselect({includeSelectAllOption:!0,buttonWidth:220,maxHeight:300,enableCaseInsensitiveFiltering:!0,enableFiltering:!0});$("#ExcelDownload").click(function(){var n=$("#NPDlist_Grid").jqGrid("getGridParam","data");if(n.length==0)alert("No data in Grid");else try{$("#NPDlist_Grid").jqGrid("exportToExcel",{includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"NPDList.xlsx",maxlength:80,exportcol:!0})}catch(t){alert(t)}});$("#SearchNpdLmData").on("click",function(){NPDListLoad()});$(document).on("click",".time_cross",function(){var n=$(this).closest("tr");n.removeClass("show_edit");n.find(".close_edit, .value_close").show();n.find("select.save_edit").hide();n.find(".save_edit1").hide();n.find(".save_edit").hide()});$(document).on("click",".close_edit",function(){var n=$(this).closest("tr");n.addClass("show_edit");n.find("select.save_edit").show();n.find(".value_close").hide()});$("body").on("change",".BusinessLaunchDate, .RandDLaunchDate",function(){rowData=getRowDataInArray(this);var n=editedNpdListData.findIndex(n=>n.MaterialCode.trim()===rowData.MaterialCode.trim());n!==-1?editedNpdListData[n]=rowData:editedNpdListData.push(rowData)});$(document).on("keydown paste",".BusinessLaunchDate",function(n){n.preventDefault()});$(document).on("keydown paste",".RandDLaunchDate",function(n){n.preventDefault()});$("[data-singleselect]").select2();$(".data-singleselect").select2();