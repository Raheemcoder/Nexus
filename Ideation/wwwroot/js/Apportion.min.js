function create_tr(n,t,i,r){var e=r=="new"?"checked":"",u=r=="new"?"":"disabled",o=$("#ApportionTracker").find("tbody"),s=$(o).find("tr").length+1,f="Totalhr";f=f+s;let h=` <tr class="valu" style="height:30px">
                                    <td style="text-align:center;">
                                        <div class="action_container">
                                            <input type="checkbox" value="`+n+`" class="childCheckBox" data-IsSelected="False" `+e+`>
                                        </div>
                                    </td>
                                    <td style="padding:0px;" >
                                     
                                           (`+n+`) (`+i+`) `+t+`
                                        
                                        <span class="projectiderrmsg text-danger" style="display:none">Please select Project</span>
                                    </td>
                                    <td style="padding:0px;">
                                    <input type="text" data-attr1="" class="form-control EfDaySplit number day1 day1split" data-attribute="1" style="background-color:#ffd6b8;height:6.4vh;" `+u+`/);
">
                                    <span class="day1errormsg text-danger dayerrmsg" style="display:none">Please enter Efforts</span>
                                    <span class="effortGreater text-danger" style="display:none">The sum of manual and apportion efforts cannot be greater than 24 Hrs</span>
                                    </td>
                                     <td style="padding:0px;">
                                     <input type="text" data-attr2="" class="form-control EfDaySplit number day2 day2split" data-attribute="2" style="height:6.4vh;" `+u+`/>
                                     <span class="day2errormsg text-danger dayerrmsg" style="display:none">Please enter Efforts</span>
    <span class="effortGreater text-danger" style="display:none">The sum of manual and apportion efforts cannot be greater than 24 Hrs</span>
                                     </td>
                                    <td style="padding:0px;">
                                    <input type="text" data-attr3="" class="form-control EfDaySplit number day3 day3split" data-attribute="3" style="height:6.4vh;" `+u+`/>
                                    <span class="day3errormsg text-danger dayerrmsg" style="display:none">Please enter Efforts</span>
    <span class="effortGreater text-danger" style="display:none">The sum of manual and apportion efforts cannot be greater than 24 Hrs</span>
                                    </td>
                                    <td style="padding:0px;">
                                    <input type="text" data-attr4="" class="form-control EfDaySplit number day4 day4split" data-attribute="4" style="height:6.4vh;" `+u+`/>
                                    <span class="day4errormsg text-danger dayerrmsg" style="display:none">Please enter Efforts</span>
    <span class="effortGreater text-danger" style="display:none">The sum of manual and apportion efforts cannot be greater than 24 Hrs</span>
                                    </td>
                                    <td style="padding:0px;">
                                    <input type="text" data-attr5="" class="form-control EfDaySplit number day5 day5split" data-attribute="5" style="height:6.4vh;" `+u+`/>
                                    <span class="day5errormsg text-danger dayerrmsg" style="display:none">Please enter Efforts</span>
    <span class="effortGreater text-danger" style="display:none">The sum of manual and apportion efforts cannot be greater than 24 Hrs</span>
                                    </td>
                                     <td style="padding:0px;">
                                     <input type="text" data-attr6="" class="form-control EfDaySplit number day6 day6split" data-attribute="6" style="height:6.4vh;" `+u+`/>
                                     <span class="day6errormsg text-danger dayerrmsg" style="display:none">Please enter Efforts</span>
    <span class="effortGreater text-danger" style="display:none">The sum of manual and apportion efforts cannot be greater than 24 Hrs</span>
                                     </td>
                                    <td style="padding:0px;">
                                    <input type="text" data-attr7="" class="form-control EfDaySplit number day7 day7split" data-attribute="7" style="background-color:#ffd6b8;height:6.4vh;" `+u+`/>
                                    <span class="day7errormsg text-danger dayerrmsg" style="display:none">Please enter Efforts</span>
    <span class="effortGreater text-danger" style="display:none">The sum of manual and apportion efforts cannot be greater than 24 Hrs</span>
                                    </td>
                                    <td style="padding: 0;vertical-align: middle;text-align: center;color: blue;background: #e7ecf7;" class="righttotalsplit">0.00</td>
                                </tr>`;$("#table_body_shared").append(h);$(".data-singleselect").select2()}function findDuplicates(n){return n.filter((t,i)=>n.indexOf(t)!==i)}function getDetails(){var n=[],t=$("#weekpicker").val().split("-");return count=0,$("#table_body_shared tr").each(function(i,r){var e,o,f,s,u,h;if($(r).find(".childCheckBox").prop("checked"))for(count++,e=$(this),o=$(e).find(".childCheckBox").val(),f=1;f<=7;f++)s="day"+f,u=$(e).find("."+s).val(),u!==null&&u!==""&&typeof u!="undefined"&&parseFloat(u)!==0&&(h=moment(t[0],"DD/MM/YYYY").add(f-1,"days").format("YYYY-MM-DD"),n.push({ProjectId:o,EffortDate:h,EffortInHrs:parseFloat(u),IsApportion:1}))}),count>0?n:($("#NoRecordsSelectedErr").show(),$(window).scrollTop($("#nav-home").position().top),0)}function getMiscellaneousDetails(){var n=[],t=$("#weekpicker").val().split("-");return count=0,$("#table_body tr").each(function(i,r){var f,e,u,o;for(count++,f=1;f<=7;f++)e="day"+f,u=$(r).find("."+e).val(),u!==null&&u!==""&&typeof u!="undefined"&&parseFloat(u)!==0&&(o=moment(t[0],"DD/MM/YYYY").add(f-1,"days").format("YYYY-MM-DD"),n.push({ProjectId:miscellaneousProjectId,EffortDate:o,EffortInHrs:parseFloat(u),IsApportion:1}))}),n.length>0?n:0}function calculateValues(){isValidData=!0;var n=0,t=0,i=0,r=0,u=0,f=0,e=0;$("[data-attr1]").each(function(t,i){n+=$(i).val()===null||$(i).val()===""||typeof $(i).val()=="undefined"?0:parseFloat($(i).data("attr1"));n>24?($(".day1totalsplit").show(),isValidData=!1):$(".day1totalsplit").hide();$(".day1totalsplitvalue").text(n.toFixed(2))});$("[data-attr2]").each(function(n,i){t+=$(i).val()===null||$(i).val()===""||typeof $(i).val()=="undefined"?0:parseFloat($(i).data("attr2"));t>24?($(".day2totalsplit").show(),isValidData=!1):$(".day2totalsplit").hide();$(".day2totalsplitvalue").text(t.toFixed(2))});$("[data-attr3]").each(function(n,t){i+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).data("attr3"));i>24?($(".day3totalsplit").show(),isValidData=!1):$(".day3totalsplit").hide();$(".day3totalsplitvalue").text(i.toFixed(2))});$("[data-attr4]").each(function(n,t){r+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).data("attr4"));r>24?($(".day4totalsplit").show(),isValidData=!1):$(".day4totalsplit").hide();$(".day4totalsplitvalue").text(r.toFixed(2))});$("[data-attr5]").each(function(n,t){u+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).data("attr5"));u>24?($(".day5totalsplit").show(),isValidData=!1):$(".day5totalsplit").hide();$(".day5totalsplitvalue").text(u.toFixed(2))});$("[data-attr6]").each(function(n,t){f+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).data("attr6"));f>24?($(".day6totalsplit").show(),isValidData=!1):$(".day6totalsplit").hide();$(".day6totalsplitvalue").text(f.toFixed(2))});$("[data-attr7]").each(function(n,t){e+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).data("attr7"));e>24?($(".day7totalsplit").show(),isValidData=!1):$(".day7totalsplit").hide();$(".day7totalsplitvalue").text(e.toFixed(2))});$("#FinalTotalSplit").text((n+t+i+r+u+f+e).toFixed(2));$(".FinalTotalSplit").text($("#FinalTotalSplit").text())}function deleteApportionData(n,t){confirm("Are You Sure You Want To Delete The Apportion Data ?",function(){var i=$("#centralmaster").jqGrid("getRowData",t),r=i.EffortStartDate,u=i.EffortEndDate;$("#centralmaster").jqGrid("delRowData",t);$("#centralmaster").trigger("reloadGrid",[{page:1}]);$.ajax({type:"POST",url:ROOT+"EffortTracker/DeleteApportionData",data:{ApportionId:n,StartDate:r,EndDate:u},dataType:"json",success:function(){},error:function(){}})})}function modalClose(){$("#showlist").modal("hide")}function showApportionData(n){var t=$("#weekefforts").val();$("#showlist").modal("show");$.ajax({type:"POST",url:ROOT+"EffortTracker/ShowApportionData",data:{ApportionId:n},dataType:"json",success:function(n){var i,t,f,r,u;if($("#apportionMaster thead").empty(),$("#apportionMaster tbody").empty(),$("#apportionMaster tfoot").empty(),i="<tr class='week_select'>",n.length!=0){const e=Object.keys(n[0])==null||Object.keys(n[0])=="undefined"?"":Object.keys(n[0]);for(t=0;t<e.length;t++)t>1?(f=moment(e[t]).format("ddd,DD MMM").split(","),i+="<th class='week_header'>"+f[0]+"<br>"+f[1]+"<\/th>"):i+="<th class='week_header'>"+e[t]+"<\/th>";i+="<th class='week_header'>Total<\/th><\/tr>";$("#apportionMaster thead").append(i);r="<tr>";for(let t=0;t<n.length;t++){const i=Object.values(n[t]);for(let u=0;u<Object.values(n[t]).length;u++)if(i[0]==null||i[0]=="undefined"||i[0]=="")continue;else r+=u>1?"<td class='day"+(u-1)+"popup'>"+(i[u]==null?0:i[u])+"<\/td>":"<td>"+i[u]+"<\/td>";r+=" <td style='padding: 0; vertical-align: middle; text-align: center; color: blue; background: #e7ecf7;text-danger;' class='righttotalpopup'>0.0<\/td><\/tr>"}$("#apportionMaster tbody").append(r);u="<tr  class='tr_padding value_ value1_'><td><\/td><td>Total Efforts<\/td>";for(let t=0;t<1;t++){const i=Object.values(n[t]);for(let i=0;i<Object.values(n[t]).length-2;i++)u+="<td><label id ='day"+(i+1)+"totalpopup'><\/label><\/td>";u+=" <td class='tf_td'><label id='FinalTotalpopup'><\/label><\/td><\/tr>"}$("#apportionMaster tfoot").append(u);handler()}else $("#apportionMaster tbody").append("No Records Found")},error:function(){}})}function handler(){var n=0,t=0,i=0,r=0,u=0,f=0,e=0;$("#viewApportionPopup tr").each(function(n,t){var i=$(t).find(".day1popup").text()===null||$(t).find(".day1popup").text()===""||typeof $(t).find(".day1popup").text()=="undefined"?0:parseFloat($(t).find(".day1popup").text()),r=$(t).find(".day2popup").text()===null||$(t).find(".day2popup").text()===""||typeof $(t).find(".day2popup").val()=="undefined"?0:parseFloat($(t).find(".day2popup").text()),u=$(t).find(".day3popup").text()===null||$(t).find(".day3popup").text()===""||typeof $(t).find(".day3popup").val()=="undefined"?0:parseFloat($(t).find(".day3popup").text()),f=$(t).find(".day4popup").text()===null||$(t).find(".day4popup").text()===""||typeof $(t).find(".day4popup").val()=="undefined"?0:parseFloat($(t).find(".day4popup").text()),e=$(t).find(".day5popup").text()===null||$(t).find(".day5popup").text()===""||typeof $(t).find(".day5popup").val()=="undefined"?0:parseFloat($(t).find(".day5popup").text()),o=$(t).find(".day6popup").text()===null||$(t).find(".day6popup").text()===""||typeof $(t).find(".day6popup").val()=="undefined"?0:parseFloat($(t).find(".day6popup").text()),s=$(t).find(".day7popup").text()===null||$(t).find(".day7popup").text()===""||typeof $(t).find(".day7popup").val()=="undefined"?0:parseFloat($(t).find(".day7popup").text());$(t).find(".righttotalpopup").text((i+r+u+f+e+o+s).toFixed(2))});$(".day1popup").each(function(t,i){n+=$(i).text()===null||$(i).text()===""||typeof $(i).text()=="undefined"?"0.0":parseFloat($(i).text());$("#day1totalpopup").text(n.toFixed(2))});$(".day2popup").each(function(n,i){t+=$(i).text()===null||$(i).text()===""||typeof $(i).text()=="undefined"?"0.0":parseFloat($(i).text());$("#day2totalpopup").text(t.toFixed(2))});$(".day3popup").each(function(n,t){i+=$(t).text()===null||$(t).text()===""||typeof $(t).text()=="undefined"?"0.0":parseFloat($(t).text());$("#day3totalpopup").text(i.toFixed(2))});$(".day4popup").each(function(n,t){r+=$(t).text()===null||$(t).text()===""||typeof $(t).text()=="undefined"?"0.0":parseFloat($(t).text());$("#day4totalpopup").text(r.toFixed(2))});$(".day5popup").each(function(n,t){u+=$(t).text()===null||$(t).text()===""||typeof $(t).text()=="undefined"?"0.0":parseFloat($(t).text());$("#day5totalpopup").text(u.toFixed(2))});$(".day6popup").each(function(n,t){f+=$(t).text()===null||$(t).text()===""||typeof $(t).text()=="undefined"?"0.0":parseFloat($(t).text());$("#day6totalpopup").text(f.toFixed(2))});$(".day7popup").each(function(n,t){e+=$(t).text()===null||$(t).text()===""||typeof $(t).text()=="undefined"?"0.0":parseFloat($(t).text());$("#day7totalpopup").text(e.toFixed(2))});$("#FinalTotalpopup").text((n+t+i+r+u+f+e).toFixed(2))}function leavesAndHolidaysHighlight(){$("#ApportionTracker thead tr th").each(function(){var n;holidays.includes($(this).attr("data-attr"))&&(n=$(this).parent().find("th").index(this),$("#ApportionTracker tbody td:nth-child("+(n+1)+") input").css("background-color","#bab7ffd1"));leaves.includes($(this).attr("data-attr"))&&(n=$(this).parent().find("th").index(this),$("#ApportionTracker tbody td:nth-child("+(n+1)+") input").css("background-color","#90EE90"))})}var ProjectList=[],count=0,projecterrorcount=0,RowNumber="",mDate,isValidData=!0,miscellaneousProjectId="",isValidEfforts=0,er=0,ProjectsData=[],SelectedRecords=[],RecordsCount=0,isSubmitted=!1,date,today,duplicateProjects,$TableHeight,month,year;$(document).ready(function(){$("#table_body_shared").find("tr").remove();$.ajax({type:"POST","async":!1,url:ROOT+"EffortTracker/GetProjectList",data:{Division:"",Classification:"",ProjectType:"",RnD:"",IsFiltered:"No"},dataType:"json",success:function(n){$("#table_body_shared").empty();$.each(n,function(n,t){ProjectsData.push(t);create_tr(t.ProjectCode,t.ProjectName,t.DivisionName,"")});RecordsCount=$("#table_body_shared").find("tr").length;$("#table_body_shared").prepend('<tr class="apportionFilter"><td><\/td><td><input type="text" class="form-control searchFilter" id="" placeholder="Search"><\/td><td class="tf_td text-danger"><label class="day1totalsplitvalue"><\/label><br><span class= "day1totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day2totalsplitvalue"><\/label><br><span class= "day2totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day3totalsplitvalue"><\/label><br><span class= "day3totalsplit text-danger font-weight:bold;" style = "display:none" > Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day4totalsplitvalue"><\/label><br><span class= "day4totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day5totalsplitvalue"><\/label><br><span class= "day5totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day6totalsplitvalue"><\/label><br><span class= "day6totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day7totalsplitvalue"><\/label><br><span class= "day7totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="FinalTotalSplit"><\/label><\/td><\/tr>');$("#tfoot").append('<tr><td colspan="10" class="tf_td text-right"><b><label class="mt-2">View 1 - '+RecordsCount+" of "+RecordsCount+"<\/label><\/b><\/td><\/tr>")},error:function(){}})});$(document).ready(function(){$(".example-dropUp").multiselect({enableFiltering:!0,includeSelectAllOption:!0,enableCaseInsensitiveFiltering:!0,maxHeight:500,buttonWidth:"100%",dropUp:!0,autoclose:!0})});$("#weekpicker").datepicker({autoclose:!0,viewMode:"months",forceParse:!1,endDate:"+0d"}).on("changeDate",function(n){var t=n.date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()),r=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()+6);$("#weekpicker").datepicker("update",i);$("#weekpicker").val(("0"+i.getDate()).slice(-2)+"/"+("0"+(i.getMonth()+1)).slice(-2)+"/"+i.getFullYear()+" - "+("0"+r.getDate()).slice(-2)+"/"+("0"+(r.getMonth()+1)).slice(-2)+"/"+r.getFullYear())});$(function(){var n=new Date(moment($("#WeekPickerHidden").val(),"DD/MM/YYYY")),t=new Date(moment($("#WeekPickerHidden").val(),"DD/MM/YYYY").add(6,"days"));$("#weekpicker").datepicker("update",n);mDate=t;$("#weekpicker").val(("0"+n.getDate()).slice(-2)+"/"+("0"+(n.getMonth()+1)).slice(-2)+"/"+n.getFullYear()+" - "+("0"+t.getDate()).slice(-2)+"/"+("0"+(t.getMonth()+1)).slice(-2)+"/"+t.getFullYear())});$(".day1, .day7").css("background-color","#ffd6b8");date=new Date;today=new Date(date.getFullYear(),date.getMonth(),date.getDate());$(".data-datepicker-month").datepicker({format:"M-yyyy",viewMode:"months",minViewMode:"months",todayHighlight:!0,autoclose:!0,maxDate:mDate});$(".data-datepicker-month").datepicker("setDate",today);$(".data-singleselect").select2();$("[data-datepicker]").datepicker({todayHighlight:!0,autoclose:!0,maxDate:mDate});$(".js-select2").select2({placeholder:"Select HUB",allowHtml:!0,allowClear:!1,includeSelectAllOption:!0});$("#searchbtn").on("click",function(){var n=$("#weekpicker").val().split("-"),t=$.trim(n[0]),i=$.trim(n[1]);window.location.href=ROOT+"EffortTracker/Apportion?q="+Encrypt("StartDate="+t+"&EndDate="+i)});duplicateProjects=[];$(".SaveData").on("click",function(){var n,t,f,e;$("#alertBox").text("");$("#alertBox").hide();var i=0,r=[],u=[];if($("#table_body_shared tr").each(function(n,t){er=0;$(t).find(".childCheckBox").prop("checked")?i++:"";$(t).each(function(n,t){$(t).find(".effortGreater:visible").length>0?r.push(1):er+0})}),$("#table_body tr").each(function(n,t){er=0;$(t).each(function(n,t){$(t).find(".effortGreater:visible").length>0?u.push(1):er+0})}),$("#Task").val()==""?($("#ApportionTaskErr").show(),n=!1,$(window).scrollTop($("#myTabContent").position().top)):$("#ApportionTaskErr").hide(),i>0){n=!0;t=getDetails();n=t==0?!1:!0;f=$("#table_body_shared tr").length-1;e=$("#weekpicker").val().split("-");$("#table_body_shared tr").each(function(){var r,t,i;if($(this).find(".childCheckBox").prop("checked"))for(r=0,t=1;t<=7;t++)i="day"+t,$(this).find("."+i).val()==""?($(this).find("."+i+"errormsg").show(),n=!1):($(this).find("."+i+"errormsg").hide(),r++),r>0&&($(this).find(".dayerrmsg").hide(),n=!0)});$("#Division").val()==""?($("#ApportionDivisionErr").show(),n=!1):$("#ApportionDivivsionErr").hide();$("#Task").val()==""?($("#ApportionTaskErr").show(),n=!1,$(window).scrollTop($("#myTabContent").position().top)):$("#ApportionTaskErr").hide();$("#RnDTeam").val().toString()==""?($("#ApportionProjectRnDErr").show(),n=!1):$("#ApportionProjectRnDErr").hide();var o=$("#Division").val().toString(),s=$("#Classification").val().toString(),h=$("#Task").val(),c=$("#ProjectType").val().toString(),l=$("#RnDTeam").val().toString(),a=$("#Apportion_Remarks").val();n&&isValidData&&r.length==0&&confirm("Please note that once Saved, the apportioned efforts cannot be updated. Do you want to continue?",function(){if($("#JsonData").val(JSON.stringify(t)),isSubmitted)return!1;isSubmitted=!0;$.ajax({url:ROOT+"EffortTracker/SaveApportionData",type:"POST","async":!1,dataType:"json",data:{EffortDetails:JSON.stringify(t),Division:o,Classification:s,TaskId:h,ProjectType:c,Rnd:l,Remarks:a},success:function(n){isSubmitted=!1;n==="Successfully Saved"?location.reload():($("#alertBox").show(),$("#alertBox").append(n),setTimeout(function(){$("#alertBox").fadeOut()},6e3))},error:function(){isSubmitted=!1}})});console.log(isSubmitted)}else $("#NoRecordsSelectedErr").show()});var JsonEfforts=$.parseJSON($("#JsonWeekEfforts").val()),effortsArr=[],val1=0,val2=0,val3=0,val4=0,val5=0,val6=0,val7=0;$(JsonEfforts).each(function(n,t){const i=Object.values(t);for(let n=0;n<i.length;n++)n==2?val1+=i[n]=="undefined"||i[n]==null?0:i[n]:"",n==3?val2+=i[n]=="undefined"||i[n]==null?0:i[n]:"",n==4?val3+=i[n]=="undefined"||i[n]==null?0:i[n]:"",n==5?val4+=i[n]=="undefined"||i[n]==null?0:i[n]:"",n==6?val5+=i[n]=="undefined"||i[n]==null?0:i[n]:"",n==7?val6+=i[n]=="undefined"||i[n]==null?0:i[n]:"",n==8?val7+=i[n]=="undefined"||i[n]==null?0:i[n]:""});effortsArr.push(val1,val2,val3,val4,val5,val6,val7);$(document).on("keyup",".EfDay",function(){var n;$("#NoRecordsErr").hide();this.value=this.value.replace(/[^0-9.]/g,"");$(this).val()!==null&&$(this).val()!==""&&typeof $(this).val()!="undefined"&&(n=/^((([0-9])|1[0-9]|2[0-3])(\.[0-9]{0,2})?|24)$/,n.test($(this).val())||$(this).val($(this).val().slice(0,-1)),$(this).removeClass("-danger"),$(this).siblings("span").hide());$("#table_body tr").each(function(n,t){var i=$(t).find(".day1").val()===null||$(t).find(".day1").val()===""||typeof $(t).find(".day1").val()=="undefined"?0:parseFloat($(t).find(".day1").val()),r=$(t).find(".day2").val()===null||$(t).find(".day2").val()===""||typeof $(t).find(".day2").val()=="undefined"?0:parseFloat($(t).find(".day2").val()),u=$(t).find(".day3").val()===null||$(t).find(".day3").val()===""||typeof $(t).find(".day3").val()=="undefined"?0:parseFloat($(t).find(".day3").val()),f=$(t).find(".day4").val()===null||$(t).find(".day4").val()===""||typeof $(t).find(".day4").val()=="undefined"?0:parseFloat($(t).find(".day4").val()),e=$(t).find(".day5").val()===null||$(t).find(".day5").val()===""||typeof $(t).find(".day5").val()=="undefined"?0:parseFloat($(t).find(".day5").val()),o=$(t).find(".day6").val()===null||$(t).find(".day6").val()===""||typeof $(t).find(".day6").val()=="undefined"?0:parseFloat($(t).find(".day6").val()),s=$(t).find(".day7").val()===null||$(t).find(".day7").val()===""||typeof $(t).find(".day7").val()=="undefined"?0:parseFloat($(t).find(".day7").val());$(t).find(".righttotal").text((i+r+u+f+e+o+s).toFixed(2))});$("#FinalTotalSplit").text(0..toFixed(2));var i=$(this).val(),r=parseFloat($(this).attr("data-attribute")),t=$(this);for(let n=0;n<7;n++)r==n+1&&(parseFloat(i)+effortsArr[n]>24?t.closest("td").find(".effortGreater").show():t.closest("td").find(".effortGreater").hide())});$(document).on("keyup",".EfDaySplit",function(){var h;isValidData=!0;this.value=this.value.replace(/[^0-9.]/g,"");$(this).val()!==null&&$(this).val()!==""&&typeof $(this).val()!="undefined"&&(h=/^((([0-9])|1[0-9]|2[0-3])(\.[0-9]{0,2})?|24)$/,h.test($(this).val())||$(this).val($(this).val().slice(0,-1)),$(this).removeClass("-danger"),$(this).closest("tr").find("span:first").hide());var c=$(this).val(),l=$(this).closest("tr").find("td:first").find(".childCheckBox").val(),s=parseFloat($(this).attr("data-attribute")),n=$(this);$(JsonEfforts).each(function(t,i){if(i.ProjectId==l){let r=Object.values(i);for(var t=1;t<8;t++)if(s==t)if(parseFloat(c)+r[t+1]>24){n.closest("td").find(".effortGreater").show();break}else s==t&&n.closest("td").find(".effortGreater").hide()}});for(let t=0;t<7;t++)s==t+1&&(parseFloat(c)+effortsArr[t]>24?n.closest("td").find(".effortGreater").show():n.closest("td").find(".effortGreater").hide());var t=0,i=0,r=0,u=0,f=0,e=0,o=0;$("#table_body_shared .day1").each(function(n,i){t+=$(i).val()===null||$(i).val()===""||typeof $(i).val()=="undefined"?0:parseFloat($(i).val());t>24?($(".day1totalsplit").show(),isValidData=!1):$(".day1totalsplit").hide();$(".day1totalsplitvalue").text(t.toFixed(2))});$("#table_body_shared .day2").each(function(n,t){i+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).val());i>24?($(".day2totalsplit").show(),isValidData=!1):$(".day2totalsplit").hide();$(".day2totalsplitvalue").text(i.toFixed(2))});$("#table_body_shared .day3").each(function(n,t){r+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).val());r>24?($(".day3totalsplit").show(),isValidData=!1):$(".day3totalsplit").hide();$(".day3totalsplitvalue").text(r.toFixed(2))});$("#table_body_shared .day4").each(function(n,t){u+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).val());u>24?($(".day4totalsplit").show(),isValidData=!1):$(".day4totalsplit").hide();$(".day4totalsplitvalue").text(u.toFixed(2))});$("#table_body_shared .day5").each(function(n,t){f+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).val());f>24?($(".day5totalsplit").show(),isValidData=!1):$(".day5totalsplit").hide();$(".day5totalsplitvalue").text(f.toFixed(2))});$("#table_body_shared .day6").each(function(n,t){e+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).val());e>24?($(".day6totalsplit").show(),isValidData=!1):$(".day6totalsplit").hide();$(".day6totalsplitvalue").text(e.toFixed(2))});$("#table_body_shared .day7").each(function(n,t){o+=$(t).val()===null||$(t).val()===""||typeof $(t).val()=="undefined"?0:parseFloat($(t).val());o>24?($(".day7totalsplit").show(),isValidData=!1):$(".day7totalsplit").hide();$(".day7totalsplitvalue").text(o.toFixed(2))});$("#table_body_shared tr").each(function(n,t){var i=$(t).find(".day1").val()===null||$(t).find(".day1").val()===""||typeof $(t).find(".day1").val()=="undefined"?0:parseFloat($(t).find(".day1").val()),r=$(t).find(".day2").val()===null||$(t).find(".day2").val()===""||typeof $(t).find(".day2").val()=="undefined"?0:parseFloat($(t).find(".day2").val()),u=$(t).find(".day3").val()===null||$(t).find(".day3").val()===""||typeof $(t).find(".day3").val()=="undefined"?0:parseFloat($(t).find(".day3").val()),f=$(t).find(".day4").val()===null||$(t).find(".day4").val()===""||typeof $(t).find(".day4").val()=="undefined"?0:parseFloat($(t).find(".day4").val()),e=$(t).find(".day5").val()===null||$(t).find(".day5").val()===""||typeof $(t).find(".day5").val()=="undefined"?0:parseFloat($(t).find(".day5").val()),o=$(t).find(".day6").val()===null||$(t).find(".day6").val()===""||typeof $(t).find(".day6").val()=="undefined"?0:parseFloat($(t).find(".day6").val()),s=$(t).find(".day7").val()===null||$(t).find(".day7").val()===""||typeof $(t).find(".day7").val()=="undefined"?0:parseFloat($(t).find(".day7").val());$(t).find(".righttotalsplit").text((i+r+u+f+e+o+s).toFixed(2))});$("#FinalTotalSplit").text((t+i+r+u+f+e+o).toFixed(2));$(".FinalTotalSplit").text($("#FinalTotalSplit").text())});$("#filterbtn").click(function(){var n=!0;if($("#Division").val()==""?($("#ApportionDivisionErr").show(),n=!1):$("#ApportionDivisionErr").hide(),$("#Classification").val()==""?($("#ApportionClassificationErr").show(),n=!1):$("#ApportionClassificationErr").hide(),$("#ProjectType").val()==""?($("#ApportionProjectTypeErr").show(),n=!1):$("#ApportionProjectTypeErr").hide(),n){$("#table_body_shared").find("tr").remove();var t=$("#Division").val().toString(),i=$("#Classification").val().toString(),r=$("#ProjectType").val().toString(),u=$("#RnDTeam").val().toString();$.ajax({type:"POST",url:ROOT+"EffortTracker/GetProjectList",data:{Division:t,Classification:i,ProjectType:r,RnD:u,IsFiltered:"Yes"},dataType:"json",success:function(n){ProjectsData=[];$("#table_body_shared").empty();$.each(n,function(n,t){ProjectsData.push(t);create_tr(t.ProjectCode,t.ProjectName,t.DivisionName,"")});n.length!=0?(RecordsCount=$("#table_body_shared").find("tr").length,$("#table_body_shared").prepend('<tr class="apportionFilter"><td><\/td><td><input type="text" class="form-control searchFilter" id="" placeholder="Search"><\/td><td class="tf_td text-danger"><label class="day1totalsplitvalue"><\/label><br><span class= "day1totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day2totalsplitvalue"><\/label><br><span class= "day2totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day3totalsplitvalue"><\/label><br><span class= "day3totalsplit text-danger font-weight:bold;" style = "display:none" > Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day4totalsplitvalue"><\/label><br><span class= "day4totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day5totalsplitvalue"><\/label><br><span class= "day5totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day6totalsplitvalue"><\/label><br><span class= "day6totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day7totalsplitvalue"><\/label><br><span class= "day7totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="FinalTotalSplit"><\/label><\/td><\/tr>'),$("#tfoot").show(),$("#tfoot tr:nth-child(2)").remove(),$("#tfoot").append('<tr><td colspan="10" class="tf_td text-right"><b><label class="mt-2">View 1 - '+RecordsCount+" of "+RecordsCount+"<\/label><\/b><\/td><\/tr>"),leavesAndHolidaysHighlight()):($("#table_body_shared").prepend('<tr class="apportionFilter"><td colspan="10" class="text-center">No Records Found<\/td><\/tr>'),$("#tfoot").hide());for(var t=1;t<8;t++)$(".day"+t+"totalsplitvalue").text(0);$("#FinalTotalSplit").text(0)},error:function(){}})}});$(".parentCheckBox").click(function(){$(".parentCheckBox").prop("checked")?($(".childCheckBox").prop("checked",!0),$("#table_body_shared tr").each(function(n,t){for(var n=1;n<=7;n++)$(t).closest("tr").find(".day"+n+"").val("").prop("disabled",!1)})):($(".childCheckBox").prop("checked",!1),$("#table_body_shared tr").each(function(n,t){for(var n=1;n<=7;n++)$(t).closest("tr").find(".day"+n+"").val("").prop("disabled",!0)}))});$(document).ready(function(){$("#SplitData").click(function(){var s=!0,h=[],t,i,r,u,f,e,o,n;$("#table_body tr").each(function(n,t){er=0;$(t).each(function(n,t){$(t).find(".effortGreater:visible").length>0?h.push(1):er+0})});$("#Task").val()==""?($("#ApportionTaskErr").show(),s=!1):$("#ApportionTaskErr").hide();$("#table_body .day1").val()==""&&$("#table_body .day2").val()==""&&$("#table_body .day3").val()==""&&$("#table_body .day4").val()==""&&$("#table_body .day5").val()==""&&$("#table_body .day6").val()==""&&$("#table_body .day7").val()==""?($("#NoRecordsErr").show(),s=!1):$("#NoRecordsErr").hide();h.length==0?s&&($("#table_body tr").each(function(n,s){t=$(s).find(".day1").val()===null||$(s).find(".day1").val()===""||typeof $(s).find(".day1").val()=="undefined"?"":$(s).find(".day1").val();i=$(s).find(".day2").val()===null||$(s).find(".day2").val()===""||typeof $(s).find(".day2").val()=="undefined"?"":$(s).find(".day2").val();r=$(s).find(".day3").val()===null||$(s).find(".day3").val()===""||typeof $(s).find(".day3").val()=="undefined"?"":$(s).find(".day3").val();u=$(s).find(".day4").val()===null||$(s).find(".day4").val()===""||typeof $(s).find(".day4").val()=="undefined"?"":$(s).find(".day4").val();f=$(s).find(".day5").val()===null||$(s).find(".day5").val()===""||typeof $(s).find(".day5").val()=="undefined"?"":$(s).find(".day5").val();e=$(s).find(".day6").val()===null||$(s).find(".day6").val()===""||typeof $(s).find(".day6").val()=="undefined"?"":$(s).find(".day6").val();o=$(s).find(".day7").val()===null||$(s).find(".day7").val()===""||typeof $(s).find(".day7").val()=="undefined"?"":$(s).find(".day7").val()}),n=0,$("#table_body_shared tr").each(function(t,i){$(i).find(".childCheckBox").prop("checked")&&n++}),n>0?($("#loader").css("visibility","visible"),$("#table_body_shared").empty(),$.each(ProjectsData,function(n,t){SelectedRecords.includes(t.ProjectCode)&&create_tr(t.ProjectCode,t.ProjectName,t.DivisionName,"new")}),$.each(ProjectsData,function(n,t){SelectedRecords.includes(t.ProjectCode)||create_tr(t.ProjectCode,t.ProjectName,t.DivisionName,"")}),RecordsCount=$("#table_body_shared").find("tr").length,$("#table_body_shared").prepend('<tr class="apportionFilter"><td><\/td><td><input type="text" class="form-control searchFilter" id="" placeholder="Search"><\/td><td class="tf_td text-danger"><label class="day1totalsplitvalue"><\/label><br><span class= "day1totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day2totalsplitvalue"><\/label><br><span class= "day2totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day3totalsplitvalue"><\/label><br><span class= "day3totalsplit text-danger font-weight:bold;" style = "display:none" > Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day4totalsplitvalue"><\/label><br><span class= "day4totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day5totalsplitvalue"><\/label><br><span class= "day5totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day6totalsplitvalue"><\/label><br><span class= "day6totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="day7totalsplitvalue"><\/label><br><span class= "day7totalsplit text-danger font-weight:bold;" style = "display:none"> Total Efforts in a day cannot be more that 24 Hrs<\/span><\/td><td class="tf_td text-danger"><label class="FinalTotalSplit"><\/label><\/td><\/tr>'),$("#table_body_shared tr").each(function(s,h){$(h).find(".childCheckBox").prop("checked")&&(t==""?"":$(h).find(".day1split").val((t/n).toFixed(2)).attr("data-attr1",t/n),i==""?"":$(h).find(".day2split").val((i/n).toFixed(2)).attr("data-attr2",i/n),r==""?"":$(h).find(".day3split").val((r/n).toFixed(2)).attr("data-attr3",r/n),u==""?"":$(h).find(".day4split").val((u/n).toFixed(2)).attr("data-attr4",u/n),f==""?"":$(h).find(".day5split").val((f/n).toFixed(2)).attr("data-attr5",f/n),e==""?"":$(h).find(".day6split").val((e/n).toFixed(2)).attr("data-attr6",e/n),o==""?"":$(h).find(".day7split").val((o/n).toFixed(2)).attr("data-attr7",o/n),$(h).find(".righttotalsplit").text((parseFloat(t/n)+parseFloat(i/n)+parseFloat(r/n)+parseFloat(u/n)+parseFloat(f/n)+parseFloat(e/n)+parseFloat(o/n)).toFixed(2)))}),$("#loader").css("visibility","hidden")):$("#NoRecordsSelectedErr").show(),calculateValues()):alert("Appotion Efforts + Manual Efforts exceeding for a day");leavesAndHolidaysHighlight()})});$("#Division").change(function(){$(this).val()==""?$("#ApportionDivisionErr").show():$("#ApportionDivisionErr").hide()});$("#Classification").change(function(){$(this).val()==""?$("#ApportionClassificationErr").show():$("#ApportionClassificationErr").hide()});$("#ProjectType").change(function(){$(this).val()==""?$("#ApportionProjectTypeErr").show():$("#ApportionProjectTypeErr").hide()});$(document).on("keyup",".searchFilter",function(){var u=this.value,t,n,i,r;for(u=u.toUpperCase(),t=$("#table_body_shared").find("tr"),n=0;n<t.length-1;n++)i=t[n+1].getElementsByTagName("td")[1],i&&(r=i.textContent||i.innerText,r=r.toUpperCase(),t[n+1].style.display=r.indexOf(u)>-1?"":"none")});$(document).on("click",".childCheckBox",function(){$(this).prop("checked")?SelectedRecords.push($(this).val()):SelectedRecords.splice(SelectedRecords.indexOf($(this).val()),1);for(var n=1;n<=7;n++)$(this).prop("checked")?$(this).closest("tr").find(".day"+n+"").prop("disabled",!1):$(this).closest("tr").find(".day"+n+"").val("").prop("disabled",!0),$(this).prop("checked")||($(this).closest("tr").find(".day"+n+"errormsg").hide(),$(this).closest("tr").find($(".righttotalsplit")).text("0.00"));$("#NoRecordsSelectedErr").hide();calculateValues()});$(".parentCheckBox").click(function(){$(this).prop("checked")?$("#table_body_shared tr").each(function(n,t){for(var i=1;i<=7;i++)$(t).closest("tr").find(".day"+i+"").val(""),$(".day"+i+"errormsg").hide(),$(`#day`+i+"totalsplit").text("0.00");n>0&&SelectedRecords.push($(this).find(".childCheckBox").val())}):SelectedRecords=[];$(".righttotalsplit").text("0.00");$("#NoRecordsSelectedErr").hide();calculateValues()});colmodels=[{name:"Action",label:"Action",width:60,search:!1,resizable:!0,ignoreCase:!0,formatter:function(n,t,i){return'<div class="text-center"><button class="plus btn-danger" title="Delete"><a onclick=deleteApportionData('+i.ApportionId+","+t.rowId+') class=""><i class="fa fa-trash" aria-hidden="true"><\/i><\/a><\/button><button class="btn-icon -view" title="View"><a onclick = showApportionData('+i.ApportionId+","+t.rowId+') class=""><i class="fa-sharp fa-solid fa-eye"><\/i><\/a><\/button><\/div>'}},{name:"EffortStartDate",label:"Effort Start Date",width:100,resizable:!0,ignoreCase:!0,formatter:"date",formatoptions:{srcformat:"Y/m/d",newformat:"d/m/Y"}},{name:"EffortEndDate",label:"Effort End Date",width:100,resizable:!0,ignoreCase:!0,formatter:"date",formatoptions:{srcformat:"Y/m/d",newformat:"d/m/Y"}},{name:"Division",label:"Division",width:70,resizable:!0,ignoreCase:!0},{name:"Classification",label:"Classification",width:120,resizable:!0,ignoreCase:!0},{name:"ProjectType",label:"Project Type",width:100,resizable:!0,ignoreCase:!0},{name:"TaskName",label:"Task Name",width:100,resizable:!0,ignoreCase:!0},{name:"RnDTeam",label:"R&D Name",width:100,resizable:!0,ignoreCase:!0},{name:"ApportionId",label:"Images Hide",resizable:!0,ignoreCase:!0,hidden:!0},];$("#centralmaster").jqGrid({url:"",datatype:"local",data:[],mtype:"GET",colModel:colmodels,loadonce:!0,viewrecords:!0,pager:"#pager_central",rowNum:20,scroll:!0,gridComplete:function(){var t=$("#centralmaster tbody tr"),r=$("#centralmaster tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))}});$("#centralmaster").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"});$(".ui-jqgrid-bdiv").css({"max-height":"calc(100vh - 155px - 155px)"});$(".ui-jqgrid-bdiv").children("div").css({"min-height":"5vh"});$TableHeight=$(".ui-jqgrid-bdiv").find("tbody").height();$TableHeight>320?($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","17px")):($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","0px"));month=(new Date).getMonth()+1;year=(new Date).getFullYear();$.ajax({type:"POST",url:ROOT+"EffortTracker/GetApportionViewData",data:{Month:month,Year:year},dataType:"json",success:function(n){n!=null&&($("#centralmaster").jqGrid("setGridParam",{data:n}),$("#centralmaster").trigger("reloadGrid",[{page:1}]))},error:function(){}});$("#apportionViewBtn").click(function(){var t=moment($("#viewMonth").val()).format("M,YYYY"),n=t.split(","),i=n[0],r=n[1];$.ajax({type:"POST",url:ROOT+"EffortTracker/GetApportionViewData",data:{Month:i,Year:r},dataType:"json",success:function(n){n!=null&&($("#centralmaster").jqGrid("clearGridData"),$("#centralmaster").jqGrid("setGridParam",{data:n}),$("#centralmaster").trigger("reloadGrid",[{page:1}]))},error:function(){}})});setTimeout(function(){$("#alertBox").hide()},5e3);$("#table_body_shared").css({"max-height":"300px","overflow-y":"scroll"});var holidaysList=JSON.parse($("#HolidaysList").val()),leavesList=JSON.parse($("#LeavesList").val()),holidays=holidaysList.flatMap(function(n){return Object.values(n)}),leaves=leavesList.flatMap(function(n){return Object.values(n)});$("#TEffortTracker thead tr th").each(function(){var n;holidays.includes($(this).attr("data-attr"))&&(n=$(this).parent().find("th").index(this),$("#TEffortTracker tbody td:nth-child("+(n+1)+") input").css("background-color","#bab7ffd1"));leaves.includes($(this).attr("data-attr"))&&(n=$(this).parent().find("th").index(this),$("#TEffortTracker tbody td:nth-child("+(n+1)+") input").css("background-color","#90EE90"))});$(document).ready(function(){leavesAndHolidaysHighlight()});$("#Apportion_Remarks").on("keypress change",function(){$("#Error_ApportionRemarks").hide()});$("#Task").on("change",function(){$("#ApportionTaskErr").hide()});$(".weekpicker").keydown(function(n){if(n.key=="Backspace")return!1});$(".weekpicker").keypress(function(n){var t,i,r;if(t=$(this).val(),i=[45],n.which>=48&&n.which<=57&&i.push(n.which),i.indexOf(n.which)==-1){n.preventDefault();return}if((t.match(/-/g)||[]).length>=2){n.preventDefault();return}if(r=/^\d{2}-\d{2}-\d{4}$/,!r.test(t)){n.preventDefault();return}});