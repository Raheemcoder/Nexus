function GetParticularIngredientData(n){var u=parseInt(n.getAttribute("data-ingredientid")),f=n.getAttribute("data-ingredientname"),t=n.getAttribute("data-synonyms"),i,r;t==="null"&&(t="");i=n.getAttribute("data-casno");r=n.getAttribute("data-function");$.ajax({type:"GET",url:ROOT+"RID/GetIngredientsRegulationById",data:{IngredientId:u},dataType:"JSON",success:function(n){$("#IngredientViewModal1").modal("show");$.jgrid.gridUnload("#viewlist");createModalGrid_modal(JSON.parse(n));$("#ActiveIngredientName").text(f);$("#ActiveSynonymName").text(t);$("#ActiveCASName").text(i);$("#ActiveFunctions").text(r)},error:function(){alert("Error occured!!")}})}function createModalGrid_modal(n){$("#viewlist").jqGrid({url:"",datatype:"local",data:n,mtype:"GET",colModel:IngridentDetailColModels,loadonce:!0,viewrecords:!0,pager:"#pager_expected1",rowNum:20,scroll:1,gridComplete:function(){var t=$("#viewlist tbody tr"),r=$("#viewlist tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))}});$("#viewlist").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"});$(".ui-jqgrid-bdiv").css({"max-height":"80vh"});$(".ui-jqgrid-bdiv").children("div").css({"min-height":"10vh"});var t=$(".ui-jqgrid-bdiv").find("tbody").height();t>280?($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","5px")):($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","0px"));$("#viewlist").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"})}function UsageStatusWithComments(n){if(n!=null){var t="",i="";return t=t+n,t=="Blue"?`<span><span class="pe-2"><i class="blue_circle"></i></span>`+i+`</span>`:t=="Green"?`<span><span class="pe-2"><i class="green_circle"></i></span>`+i+`</span>`:t=="Yellow"?`<span><span class="pe-2"><i class="yellow_circle"></i></span>`+i+`</span>`:t=="Red"?`<span><span class="pe-2"><i class="red_circle"></i></span>`+i+`</span>`:""}return""}function Get_UpdateIngredient(n){var t=n.getAttribute("data-IngredientName");$("#IngredientName_valid").addClass("_hide");$("#CASNumber_valid").addClass("_hide");t===null||t===""||typeof t=="undefined"?($("#title").text("Add Ingredient"),$("#IngredientName").val(""),$("#CASNumber").val(""),$("#FunctionId").val("").trigger("change"),$("#IngredientName").attr("disabled",!1),$("#CASNumber").attr("disabled",!1)):($("#title").text("Edit Ingredient"),$.ajax({url:ROOT+"RID/AddIngredient",data:{IngredientName:t},type:"GET",success:function(n){data=JSON.parse(n);$("#IngredientName").val(data[0].ingredientname);$("#CASNumber").val(data[0].casno);$("#FunctionId").val(data[0].functionname).trigger("change");$("#IngredientName").attr("disabled",!0);$("#CASNumber").attr("disabled",!0)}}))}function FormateDateForSearch(n){var t=n.getDate(),i=n.getMonth()+1;return t=(t<10?"0":"")+t,i=(i<10?"0":"")+i,n.getFullYear()+"-"+i+"-"+t}function GetSearchResult(n,t,i){$.ajax({type:"GET",url:ROOT+"RID/GetIngredientBasedOnSearchRegulation",data:{StartDate:n,EndDate:t,Status:i},dataType:"JSON",success:function(n){$.jgrid.gridUnload("#rideditview");createMainGrid(JSON.parse(n))},error:function(){alert("Error occured!!")}})}function createMainGrid(n){jQuery("#rideditview").jqGrid({datatype:"local",data:n,colModel:[{name:"Action",label:"Action",width:60,resizable:!0,ignoreCase:!0,formatter:function(n,t,i){var r='<div class="text-center">';return i.Status=="Open"?r+='<a href="'+ROOT+"RID/AddIngredientRequest?q="+Encrypt("ingredientId="+i.IngredientReqId)+'" class="btn-icon -edit" data-IngredientName="'+i.IngredientName+'" data-Casno="'+i.CASNumber+'" data-Region="'+i.Region+'" data-function="'+i.FunctionName+'"><i class="fas fa-edit"><\/i><\/a>':r="",r},search:!1},{name:"IngredientName",label:"Ingredient Name",resizable:!0,ignoreCase:!0,search:!0,width:200},{name:"CASNumber",label:"CAS Number",resizable:!0,ignoreCase:!0,search:!0,width:90},{name:"FunctionName",label:"Functions",width:330,resizable:!0,search:!0,ignorecase:!0,cellattr:functionAttrSetting},{name:"Region",label:"Region",resizable:!0,ignoreCase:!0,search:!0,width:150},{name:"Status",label:"Status",resizable:!0,ignoreCase:!0,search:!0,width:90,search:!0},{name:"CreatedBy",label:"Requested By",resizable:!0,ignoreCase:!0,search:!0,width:150},{name:"CreatedDate",label:"Requested Date",resizable:!0,ignoreCase:!0,search:!0,width:100},],loadonce:!0,pager:"#rideditview_Pager",viewrecords:!0,ignoreCase:!0,rowNum:n.length,scroll:1,gridComplete:function(){var t=$("#ingredient tbody tr"),r=$("#ingredient tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))}});$("#rideditview").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"});$(".ui-jqgrid-bdiv").css({"max-height":"59vh"});$(".ui-jqgrid-bdiv").children("div").css({"min-height":"10vh"});var t=$(".ui-jqgrid-bdiv").find("tbody").height();t>280?($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","5px")):($(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","0px"));$("#rideditview").closest("#gview_rideditview").css({"z-index":"0"})}var oldRegion,data=[],IngridentDetailColModels,start,end,isValidStartDateFlag,isValidEndDateFlag;arrtSetting=function(n,t){var i,r,u;return(oldRegion=undefined||oldRegion!=t)?(r=data.filter(function(n){return n.Region===t}),u=r.length,i=' rowspan="'+u+'"'):i=' style="display:none"',oldRegion=t,i};IngridentDetailColModels=[{name:"RowNo",align:"center",hidden:!0},{name:"Region",align:"center",classes:"trs",cellattr:arrtSetting,formatter:function(n){return n}},{name:"Category",classes:"trs1",formatter:function(n){return n}},{name:"RegulatoryStatus",label:"Regulatory<br>Status",align:"center",resizable:!0,ignoreCase:!0,search:!0,width:80},{name:"CRemarks",label:"Compliance Remarks",align:"center",resizable:!0,ignoreCase:!0,search:!0,width:250},{name:"ImpactDates",label:"Impact Dates",align:"center",resizable:!0,ignoreCase:!0,search:!0,width:200,formatter:function(n){if(!n)return"";var t=n.split(" ")[0].split("/"),i=parseInt(t[0]),r=parseInt(t[1]),u=parseInt(t[2]),f=new Date(u,i-1,r);return f.toLocaleDateString()}},{name:"References",label:"References",align:"center",resizable:!0,ignoreCase:!0,search:!0,width:150},{name:"INCI",label:"INCI",align:"center",resizable:!0,ignoreCase:!0,search:!0,width:150,align:"right"},];$(document).ready(function(){$("#StatusId").val("111").trigger("change");GetSearchResult("","",$("#StatusId").val())});start=new Date;end=new Date((new Date).setYear(start.getFullYear()+1));$("[-datepicker-startdate]").datepicker({format:"dd/mm/yyyy",endDate:end,autoclose:!0}).on("changeDate",function(){$("[-datepicker-enddate]").datepicker("setStartDate",$(this).val())});$("[-datepicker-enddate]").datepicker({format:"dd/mm/yyyy",startDate:start,endDate:end,autoclose:!0}).on("changeDate",function(){$("[-datepicker-startdate]").datepicker("setEndDate",$(this).val())});isValidStartDateFlag=1;isValidEndDateFlag=1;$("#Search_Start_Date").on("change",function(){var n=$("#Search_Start_Date").val();n.length>10||n.length<10?($("#Err_Search_Start_Date").show(),isValidStartDateFlag=0):($("#Err_Search_Start_Date").hide(),isValidStartDateFlag=1)});$("#Search_End_Date").on("change",function(){var n=$("#Search_End_Date").val();n.length>10||n.length<10?($("#Err_Search_End_Date").show(),isValidEndDateFlag=0):($("#Err_Search_End_Date").hide(),isValidEndDateFlag=1)});$("#search_ingredient").on("click",function(){var r,u;if(isValidEndDateFlag==1&&isValidStartDateFlag==1){var n=$("[-datepicker-startdate]").datepicker("getDate"),t=$("[-datepicker-enddate]").datepicker("getDate"),i=$("#StatusId").val();n==null&&t==null&&i==""?alert("There is no data to search"):n!=undefined&&n!=null&&n!=""&&t!=undefined&&t!=null&&t!=""&&i!=undefined&&i!=null&&i!=""?(r=FormateDateForSearch(n),u=FormateDateForSearch(t),GetSearchResult(r,u,i)):n!=undefined&&n!=null&&n!=""&&t!=undefined&&t!=null&&t!=""&&(i==undefined||i==null||i=="")?(r=FormateDateForSearch(n),u=FormateDateForSearch(t),GetSearchResult(r,u,"")):(n==undefined||n==null||n=="")&&(t==undefined||t==null||t=="")&&i!=undefined&&i!=null&&i!=""?GetSearchResult("","",i):alert("There is no data to search")}else alert("Please select a valid date")});$("#refresh_date").on("click",function(){$("[-datepicker-startdate]").datepicker("destroy");$("[-datepicker-startdate]").val("");$("[-datepicker-startdate]").datepicker({format:"dd/mm/yyyy",autoclose:!0});$("[-datepicker-enddate]").datepicker("destroy");$("[-datepicker-enddate]").val("");$("[-datepicker-enddate]").datepicker({format:"dd/mm/yyyy",autoclose:!0});$("#StatusId").val("111").trigger("change");GetSearchResult("","","111")});functionAttrSetting=function(n,t){return t.length>200?'style="white-space:nowrap !important;"':""};