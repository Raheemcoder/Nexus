function UsageStatus(n){if(n!=null){if(n=="Red")return'<span class="pe-2"><i class="red_circle"><\/i><\/span>';if(n=="Blue")return'<span class="pe-2"><i class="blue_circle"><\/i><\/span>';if(n=="Yellow")return'<span class="pe-2"><i class="yellow_circle"><\/i><\/span>';if(n=="Green")return'<span class="pe-2"><i class="green_circle"><\/i><\/span>'}else return""}function GetParticularIngredientData(n,t){var i=t.closest("tr.jqgrow"),r=i.id,u=$("#IngredientListGrid"),f=u.jqGrid("getCell",r,"IngredientName"),e=$(f).text().trim();$.ajax({type:"GET",url:ROOT+"RID/GetParticularIngredientDetails",data:{IngredientId:n},dataType:"JSON",success:function(n){var t=JSON.parse(n);$("#ParticularIngredientDetails").jqGrid("clearGridData");t!=undefined&&$("#ParticularIngredientDetails").jqGrid("setGridParam",{data:t}).trigger("reloadGrid",[{page:1}]);$("#ParticularIngredientDetailsModal").modal("show");$("#ActiveIngredientName").text(e)},error:function(){alert("Error occured!!")}})}function UsageStatusWithComments(n){if(n!=null){var t="",i="",r=n.indexOf("-");return t=n.substr(0,r),i=n.substr(r+1,n.length),t=="Blue"?`<span>`+i+`</span>`:t=="Green"?`<span>`+i+`</span>`:t=="Yellow"?`<span>`+i+`</span>`:t=="Red"?`<span>`+i+`</span>`:""}return""}function FormateDateForSearch(n){var t=n.getDate(),i=n.getMonth()+1;return t=(t<10?"0":"")+t,i=(i<10?"0":"")+i,n.getFullYear()+"-"+i+"-"+t}function GetSearchResult(n,t,i){$.ajax({type:"GET",url:ROOT+"RID/GetIngredientBasedOnSearch",data:{StartDate:n,EndDate:t,SearchText:i,Source:"RnD"},dataType:"JSON",success:function(n){var t=JSON.parse(n);$("#IngredientListGrid").jqGrid("clearGridData");t!=undefined&&$("#IngredientListGrid").jqGrid("setGridParam",{data:t}).trigger("reloadGrid",[{page:1}])},error:function(){alert("Error occured!!")}})}function UsageStatusWithCommentsForPopup(n){if(n!=null){var t="",i="";return t=t+n,t=="Blue"?`<span><span class="pe-2"><i class="blue_circle"></i></span>`+i+`</span>`:t=="Green"?`<span><span class="pe-2"><i class="green_circle"></i></span>`+i+`</span>`:t=="Yellow"?`<span><span class="pe-2"><i class="yellow_circle"></i></span>`+i+`</span>`:t=="Red"?`<span><span class="pe-2"><i class="red_circle"></i></span>`+i+`</span>`:""}return""}function GetParticularIngredientData(n){var t,u;var r=n.getAttribute("data-ingredientid"),f=n.getAttribute("data-ingredientname"),i=n.getAttribute("data-synonyms");i==="null"&&(i="");t=n.getAttribute("data-casno");t==="null"&&(t="");u=n.getAttribute("data-function");$.ajax({type:"GET",url:ROOT+"RID/GetIngredientsRegulationById",data:{IngredientId:r},dataType:"JSON",success:function(n){$("#IngredientModal1").modal("show");$.jgrid.gridUnload("#ingriedienttable");data=JSON.parse(n);createModalGrid();$("#ActiveIngredientName").text(f);$("#ActiveSynonymName").text(i);$("#ActiveCASName").text(t);$("#ActiveFunctions").text(u);$("#IngredientId").val(r)},error:function(){alert("Error occured!!")}})}function createModalGrid(){oldRegion="";$("#ingriedienttable").jqGrid({url:"",datatype:"local",data:data,mtype:"GET",colModel:IngridentColModels,loadonce:!0,viewrecords:!0,pager:"#pager_expected1",rowNum:100,scroll:1,gridComplete:function(){var t=$("#ingriedienttable tbody tr"),r=$("#ingriedienttable tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))}});$("#ingriedienttable").closest(".ui-jqgrid-bdiv").css({"max-height":"48vh"});$("#ingriedienttable").closest(".ui-jqgrid-bdiv").children("div").css({"min-height":"10vh"});var n=$("#ingriedienttable").closest(".ui-jqgrid-bdiv").find("tbody").height();n>280?($("#ingriedienttable").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#ingriedienttable").closest(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","5px")):($("#ingriedienttable").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#ingriedienttable").closest(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","0px"))}function ViewUploadedFiles(n,t){var i=parseInt($("#IngredientId").val());$.ajax({url:ROOT+"RID/DisplayUploadedFiles",type:"POST",dataType:"JSON",data:{IngredientId:i,RegionId:n,CategoryId:t},success:function(n){$.jgrid.gridUnload("#FileUploadjqgrid");var t=JSON.parse(n);$("#displayuploadedfiles").modal("show");CreateJQGridUploadFile(t)}})}function CreateJQGridUploadFile(n){$("#FileUploadjqgrid").jqGrid({url:"",datatype:"local",data:n,mtype:"GET",colModel:IngredientFileColModels,loadonce:!0,viewrecords:!0,pager:"#FileUploadpager",rowNum:100,scroll:1,gridComplete:function(){var t=$("#FileUploadjqgrid tbody tr"),r=$("#FileUploadjqgrid tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))}});$("#FileUploadjqgrid").closest(".ui-jqgrid-bdiv").css({"max-height":"48vh"});$("#FileUploadjqgrid").closest(".ui-jqgrid-bdiv").children("div").css({"min-height":"10vh"});var t=$("#FileUploadjqgrid").closest(".ui-jqgrid-bdiv").find("tbody").height();t>280?($("#FileUploadjqgrid").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#FileUploadjqgrid").closest(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","5px")):($("#FileUploadjqgrid").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#FileUploadjqgrid").closest(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","0px"))}function downloadoc(n){var t=parseInt($("#IngredientId").val()),i=n.getAttribute("data-region"),r=n.getAttribute("data-category"),u=n.getAttribute("data-enclosure");window.location.href=ROOT+"RID/FileDownload?docName="+u+"&&ingredientId="+t+"&&regionId="+i+"&&categoryId="+r}var oldRegion="",data=[],IngredientListGridData=$("#DivisionBasedIngredientListJson").val(),DivisionBasedIngredientList=[],ComplianceRequestListData,ComplianceRequestList,start,end,$TableHeight,IngridentColModels,IngredientFileColModels;IngredientListGridData!=undefined&&IngredientListGridData!=null&&IngredientListGridData!=""&&(DivisionBasedIngredientList=$.parseJSON(IngredientListGridData));ComplianceRequestListData=$("#ComplianceRequestListJson").val();ComplianceRequestList=[];ComplianceRequestListData!=undefined&&ComplianceRequestListData!=null&&ComplianceRequestListData!=""&&(ComplianceRequestList=$.parseJSON(ComplianceRequestListData));functionAttrSetting=function(n,t){return t.length>200?'style="white-space:nowrap !important;"':""};arrtSetting=function(n,t){var i,r,u;return oldRegion===""||oldRegion!=t?(r=data.filter(function(n){return n.Region===t}),u=r.length,i=' rowspan="'+u+'"'):i=' style="display:none"',oldRegion=t,i};add_color=function(n,t,i){var r="";return(i.IsEdited==1||i.IsEdited==2)&&(r='class="add-edited-color"'),r};IngridentListColModels=[{name:"IsEdited",label:"IsEdited",resizable:!0,ignoreCase:!0,hidden:!0,cellattr:add_color},{name:"IngredientName",label:"Ingredient Name",resizable:!0,ignoreCase:!0,formatter:function(n,t,i){return'<a href="#" class="rid_" data-target="#IngredientModal1" data-ingredientid="'+i.IngredientId+'" data-ingredientname="'+i.IngredientName+'"  data-synonyms="'+i.Synonyms+'" data-casno = "'+i.CASNumber+'" data-function = "'+i.FunctionName+'" onclick="GetParticularIngredientData(this)">'+n+"<\/a>"}},{name:"Synonyms",label:"Synonyms",resizable:!0,ignoreCase:!0,index:"Synonyms"},{name:"CASNumber",label:"CAS Number",resizable:!0,ignoreCase:!0},{name:"FunctionName",label:"Functions",resizable:!0,ignorecase:!0,cellattr:functionAttrSetting},{name:"AdultLeaveOn",label:"Adult - Leave On",resizable:!0,align:"center",ignorecase:!0,index:"AdultLeaveOn",formatter:function(n){return UsageStatus(n)}},{name:"AdultRinseOff",label:"Adult - Rinse Off",resizable:!0,ignorecase:!0,align:"center",index:"AdultRinseOff",formatter:function(n){return UsageStatus(n)}},{name:"BabyLeaveOn",label:"Baby - Leave On",resizable:!0,ignorecase:!0,align:"center",index:"BabyLeaveOn",formatter:function(n){return UsageStatus(n)}},{name:"BabyRinseOff",label:"Baby - Rinse Off",resizable:!0,ignorecase:!0,align:"center",index:"BabyRinseOff",formatter:function(n){return UsageStatus(n)}},{name:"LastUpdatedDate",label:"Last Updated Date",resizable:!0,ignorecase:!0},];$("#IngredientListGrid").jqGrid({url:"",datatype:"local",data:DivisionBasedIngredientList.length>0?DivisionBasedIngredientList:[],mtype:"GET",colModel:IngridentListColModels,loadonce:!0,viewrecords:!0,pager:"#IngredientListGrid_Pager",rowNum:DivisionBasedIngredientList.length,scroll:1,gridComplete:function(){var t=$("#IngredientListGrid tbody tr"),r=$("#IngredientListGrid tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"));$(".add-edited-color").siblings("td").addClass("add-edited-color");$(".add-rollback-color").siblings("td").addClass("add-rollback-color")}});$("#IngredientListGrid").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"});jQuery("#IngredientListGrid").jqGrid("setGroupHeaders",{useColSpanStyle:!0,groupHeaders:[{startColumnName:"AdultLeaveOn",numberOfColumns:4,titleText:'<div id="Usage" class="text-center">Usage<\/div>',index:"Usage",name:"Usage"}]});$("#Usage").closest("th").addClass("testing");$("#IngredientListGrid").closest(".jqg-first-row-header").hide();$("#IngredientListGrid").closest(".ui-jqgrid-bdiv").css({"max-height":"55vh"});$("#IngredientListGrid").closest(".ui-jqgrid-bdiv").children("div").css({"min-height":"0vh"});$TableHeight=$("#IngredientListGrid").closest(".ui-jqgrid-bdiv").find("tbody").height();$TableHeight>130?($("#IngredientListGrid").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#IngredientListGrid").closest(".-virtual-scroll").find(".ui-jqgrid-hdiv").css("padding-right","6px")):($("#IngredientListGrid").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#IngredientListGrid").closest(".-virtual-scroll").find(".ui-jqgrid-hdiv").css("padding-right","0px"));$("#IngredientListGrid").closest("#gview_IngredientListGrid").css({"z-index":"0"});IngridentDetailColModels=[{name:"Region",label:"Region",width:70,resizable:!0,ignorecase:!0},{name:"AdultLeaveOn",label:"Adult - Leave On",resizable:!0,width:120,ignorecase:!0,formatter:function(n){return UsageStatusWithComments(n)}},{name:"AdultRinseOff",label:"Adult - Rinse Off",width:120,resizable:!0,ignorecase:!0,formatter:function(n){return UsageStatusWithComments(n)}},{name:"BabyLeaveOn",label:"Baby - Leave On",resizable:!0,width:120,ignorecase:!0,formatter:function(n){return UsageStatusWithComments(n)}},{name:"BabyRinseOff",label:"Baby - Rinse Off",resizable:!0,width:120,ignorecase:!0,formatter:function(n){return UsageStatusWithComments(n)}},];$("#ParticularIngredientDetails").jqGrid({url:"",datatype:"local",data:[],mtype:"GET",colModel:IngridentDetailColModels,loadonce:!0,viewrecords:!0,pager:"#ParticularIngredientDetails_Pager",rowNum:20,scroll:1,gridComplete:function(){var t=$("#ParticularIngredientDetails tbody tr"),r=$("#ParticularIngredientDetails tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))}});$("#ParticularIngredientDetails").closest(".jqg-first-row-header").hide();$("#ParticularIngredientDetails").closest(".ui-jqgrid-bdiv").css({"max-height":"55vh"});$("#ParticularIngredientDetails").closest(".ui-jqgrid-bdiv").children("div").css({"min-height":"10vh"});$TableHeight=$("#ParticularIngredientDetails").closest(".ui-jqgrid-bdiv").find("tbody").height();$TableHeight>280?($("#ParticularIngredientDetails").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#ParticularIngredientDetails").closest(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","5px")):($("#ParticularIngredientDetails").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#ParticularIngredientDetails").closest(".-virtual-scroll").find(".ui-jqgrid-hbox").css("padding-right","0px"));$("#search_ingredient").on("click",function(){var n=$("[-datepicker-startdate]").datepicker("getDate"),t=$("[-datepicker-enddate]").datepicker("getDate"),i=$("#global_search").val().trim(),r,u;n==null&&t==null&&i==""?alert("There is no data to search"):n!=undefined&&n!=null&&n!=""&&t!=undefined&&t!=null&&t!=""&&i!=undefined&&i!=null&&i!=""?(r=FormateDateForSearch(n),u=FormateDateForSearch(t),GetSearchResult(r,u,i)):n!=undefined&&n!=null&&n!=""&&t!=undefined&&t!=null&&t!=""&&(i==undefined||i==null||i=="")?(r=FormateDateForSearch(n),u=FormateDateForSearch(t),GetSearchResult(r,u,"")):(n==undefined||n==null||n=="")&&(t==undefined||t==null||t=="")&&i!=undefined&&i!=null&&i!=""?GetSearchResult("","",i):n!=undefined&&n!=null&&n!=""&&(t==undefined||t==null||t=="")||(n==undefined||n==null||n=="")&&t!=undefined&&t!=null&&t!=""?alert("Please select both start date and end date for search"):alert("There is no data to search")});$("#refresh_date").on("click",function(){$("[-datepicker-startdate]").datepicker("destroy");$("[-datepicker-startdate]").val("");$("[-datepicker-startdate]").datepicker({format:"dd/mm/yyyy",autoclose:!0});$("[-datepicker-enddate]").datepicker("destroy");$("[-datepicker-enddate]").val("");$("[-datepicker-enddate]").datepicker({format:"dd/mm/yyyy",autoclose:!0});$("#global_search").val("");GetSearchResult("","","")});start=new Date;end=new Date((new Date).setYear(start.getFullYear()+1));$("[-datepicker-startdate]").datepicker({format:"dd/mm/yyyy",endDate:end,autoclose:!0}).on("changeDate",function(){$("[-datepicker-enddate]").datepicker("setStartDate",$(this).val())});$("[-datepicker-enddate]").datepicker({format:"dd/mm/yyyy",startDate:start,endDate:end,autoclose:!0}).on("changeDate",function(){$("[-datepicker-startdate]").datepicker("setEndDate",$(this).val())});$("#ComplianceRequest_popup").on("click",function(){$("#Request_Ingrident").val("");$("#Request_CASNumber").val("");$("#Request_Region").val("").multiselect("refresh");$("#Request_Function").val("").multiselect("refresh");$("#IRAStatusDropDown").val("111").trigger("change");$("#search_ComplianceRequestList").trigger("click");$("#Err_Request_Ingredient").hide();$("#Err_Request_CASNumber").hide();$("#Err_Request_Region").hide();$("#NewIngredient_Request").modal("show")});$("#Request_Ingrident").on("keyup",function(){var n=$.trim($("#Request_Ingrident").val());n.length>0?$("#Err_Request_Ingredient").hide():$("#Err_Request_Ingredient").show()});$("#Request_Region").on("change",function(){var n=$.trim($("#Request_Region").val());n.length>0?$("#Err_Request_Region").hide():$("#Err_Request_Region").show()});$("#ComplianceRequest_save").on("click",function(){var t,n,i,r;if($(".Err_Request").hide(),t=$.trim($("#Request_Ingrident").val()),n=$.trim($("#Request_CASNumber").val()),(n==null||typeof n=="undefined")&&(n=""),i=$.trim($("#Request_Region").val()),r=$.trim($("#Request_Function").val()),t.length==0||i.length==0)t.length==0?$("#Err_Request_Ingredient").show():$("#Err_Request_Ingredient").hide(),i.length==0?$("#Err_Request_Region").show():$("#Err_Request_Region").hide();else{$("#RequestSave_Confirmation_Modal").modal("show");$("#RequestSave_ok").off("click").on("click",function(){$("#RequestSave_Confirmation_Modal").modal("hide");$.ajax({type:"POST",url:ROOT+"RID/ComplianceRequest_Save",data:{IngredientName:t,Region:i,FunctionId:r,CASNumber:n},success:function(n){var t=JSON.parse(n),i=document.getElementById("ComplianceRequestResultAlert"),r=document.getElementById("ComplianceRequestResultMessage");i.classList.remove("alert-success","alert-danger");i.classList.add(t.Item2);r.textContent=t.Item1;i.style.display="block";t.Item2.toLowerCase().includes("success")&&($("#Request_Ingrident").val(""),$("#Request_CASNumber").val(""),$("#Request_Region").val("").multiselect("refresh"),$("#Request_Function").val("").multiselect("refresh"),$("#IRAStatusDropDown").val("111").trigger("change"),$("#search_ComplianceRequestList").trigger("click"));setTimeout(function(){$("#ComplianceRequestResultAlert").hide()},5e3)},error:function(n){alert(n)}})});$("#RequestSave_cancel").off("click").on("click",function(){$("#RequestSave_Confirmation_Modal").modal("hide")})}});ComplianceRequestListColModels=[{name:"IngredientName",label:"Ingredient Name",resizable:!0,ignoreCase:!0,width:150},{name:"CASNumber",label:"CAS Number",resizable:!0,ignoreCase:!0,width:120},{name:"FunctionName",label:"Functions",width:250,resizable:!0,ignorecase:!0,cellattr:functionAttrSetting},{name:"Region",label:"Region",width:120,resizable:!0,ignorecase:!0},{name:"Status",label:"Status",resizable:!0,ignoreCase:!0,width:80},{name:"CreatedBy",label:"Requested By",resizable:!0,ignoreCase:!0,search:!0,width:80},{name:"CreatedDate",label:"Requested Date",resizable:!0,ignoreCase:!0,search:!0,width:80},];$("#ComplianceRequestGrid").jqGrid({url:"",datatype:"local",data:[],mtype:"GET",colModel:ComplianceRequestListColModels,loadonce:!0,viewrecords:!0,pager:"#ComplianceRequestGrid_Pager",rowNum:1e3,scroll:1,gridComplete:function(){var t=$("#ComplianceRequestGrid tbody tr"),r=$("#ComplianceRequestGrid tbody tr td"),n;if(t.length>1)for(n=$(t[1]).children("td"),i=0;i<n.length;i++)$(n[i]).css("width",$(r[i]).css("width"))}});$("#ComplianceRequestGrid").jqGrid("filterToolbar",{autosearch:!0,stringResult:!1,searchOnEnter:!1,defaultSearch:"cn"});$("#ComplianceRequestGrid").closest(".jqg-first-row-header").hide();$("#ComplianceRequestGrid").closest(".ui-jqgrid-bdiv").css({"max-height":"30vh"});$("#ComplianceRequestGrid").closest(".ui-jqgrid-bdiv").children("div").css({"min-height":"0vh"});$TableHeight=$("#ComplianceRequestGrid").closest(".ui-jqgrid-bdiv").find("tbody").height();$TableHeight>130?($("#ComplianceRequestGrid").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#ComplianceRequestGrid").closest(".-virtual-scroll").find(".ui-jqgrid-hdiv").css("padding-right","6px")):($("#ComplianceRequestGrid").closest(".ui-jqgrid").find(".ui-jqgrid-bdiv").css("overflow","auto"),$("#ComplianceRequestGrid").closest(".-virtual-scroll").find(".ui-jqgrid-hdiv").css("padding-right","0px"));$("#search_ComplianceRequestList").on("click",function(){var n=$("#IRAStatusDropDown").val();$.ajax({type:"GET",url:ROOT+"RID/GetComplianceRequestBasedOnSearch",data:{Status:n},dataType:"JSON",success:function(n){var t=JSON.parse(n);$("#ComplianceRequestGrid").jqGrid("clearGridData");t!=undefined&&$("#ComplianceRequestGrid").jqGrid("setGridParam",{data:t}).trigger("reloadGrid",[{page:1}])},error:function(){alert("Error occured!!")}})});IngridentColModels=[{name:"RowNo",align:"center",hidden:!0},{name:"Region",align:"center",classes:"trs",cellattr:arrtSetting,formatter:function(n){return n}},{name:"Category",classes:"trs1",formatter:function(n){return n}},{name:"RegulatoryStatus",label:"Regulatory<br>Status",align:"center",resizable:!0,ignoreCase:!0,search:!0,width:80,hidden:!0,formatter:function(n){return UsageStatusWithCommentsForPopup(n)}},{name:"CRemarks",label:"Compliance Remarks",resizable:!0,ignoreCase:!0,search:!0,width:250},{name:"ImpactDates",label:"Impact Date",resizable:!0,ignoreCase:!0,search:!0,width:200},{name:"References",label:"References",resizable:!0,ignoreCase:!0,search:!0,width:150},{name:"ReferenceDoc",label:"Reference Doc",align:"center",resizable:!0,ignoreCase:!0,search:!0,width:100,formatter:function(n,t,i){return i.IsFileExists==!0?'<a href="javascript: void(0);" class="grid-icon-only approveicon" onclick="ViewUploadedFiles('+i.RegionId+","+i.CategoryId+')" class="icon_color text-success btn_button" title="view"><i class="fas fa-eye"><\/i><\/a>':""}},];$("#closebtn").click(function(){$("#IngredientModal1").modal("hide")});IngredientFileColModels=[{name:"RegionId",label:"RegionId",hidden:!0},{name:"CategoryId",label:"CategoryId",hidden:!0},{name:"EnclosureName",label:"File Name",width:250},{name:"UploadedBy",label:"Uploaded By",width:150},{name:"UploadedOn",label:"Uploaded Date",width:100},{name:"Action",align:"center",width:50,formatter:function(n,t,i){return'<div class="demo-content "><a href="#" title="Download" class="btn-icon btn-success" onclick="downloadoc(this)" data-region="'+i.RegionId+'" data-category="'+i.CategoryId+'" data-enclosure="'+i.EnclosureName+'" ><i class="fa fa-download"><\/i><\/a><\/div >'}},];